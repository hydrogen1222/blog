
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hexo">
    <title>Archives: 2025 - Hexo</title>
    <meta name="author" content="John Doe">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://hydrogen1222.xyz/all-archives/2025/page/2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    




<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      tags: 'ams'
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>





<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            Hexo
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/hydrogen1222"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://user.qzone.qq.com/2170147489/infocenter"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="QQ"
                        >
                        <i class="sidebar-button-icon fab fa-qq" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">QQ</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://space.bilibili.com/441987358?spm_id_from=333.1007.0.0"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="bilibili"
                        >
                        <i class="sidebar-button-icon fab fa-bilibili" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">bilibili</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:tanch1222@mails.jlu.edu.cn"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/06/06/%E7%A7%91%E7%A0%94/first%20stage/%E5%85%B3%E4%BA%8ERietveld%E7%B2%BE%E4%BF%AE/"
                            aria-label=": 从零开始的Rietveld精修"
                        >
                            从零开始的Rietveld精修
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-06-06T12:20:02+08:00">
	
		    Jun 06, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/first-stage/">first stage</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>we</p>
<p>we <span class="math display">$$
WSS=\sum_i w_i(I_i^{exp}-I_i^{calc})^2, w_i=\dfrac{1}{I_i^{exp}}
$$</span></p>
<p><span
class="math display"><em>I</em><sub><em>i</em></sub><sup><em>c</em><em>a</em><em>l</em><em>c</em></sup> = <em>S</em><sub><em>F</em></sub>∑<sub><em>k</em></sub><em>L</em><sub><em>k</em></sub>|<em>F</em><sub><em>k</em></sub>|<sup>2</sup><em>S</em>(2<em>θ</em><sub><em>i</em></sub> − 2<em>θ</em><sub><em>k</em></sub>)<em>P</em><sub><em>k</em></sub><em>A</em> + <em>b</em><em>k</em><em>g</em><sub><em>i</em></sub></span></p>
<p>其中，<span
class="math inline"><em>P</em><sub><em>k</em></sub></span>是优选取向函数，<span
class="math inline"><em>S</em>(2<em>θ</em><sub><em>i</em></sub> − 2<em>θ</em><sub><em>k</em></sub>)</span>是剖面形状函数，PV=<span
class="math inline"><em>η</em></span>(HWHM)，HWHM<span
class="math inline"><sup>2</sup></span>=<span
class="math inline"><em>U</em>tan<sup>2</sup><em>θ</em> + <em>V</em>tan <em>θ</em> + <em>W</em></span>
<span class="math display">$$
P_k=(r^2\cos^2\alpha+\dfrac{\sin^2\alpha}{r})^{-\frac{3}{2}}
$$</span></p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/06/06/%E7%A7%91%E7%A0%94/first%20stage/%E5%85%B3%E4%BA%8ERietveld%E7%B2%BE%E4%BF%AE/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/30/%E9%87%8F%E5%AD%90%E5%8C%96%E5%AD%A6/%E4%BD%BF%E7%94%A8Multiwfn+VMD%E7%BB%98%E5%88%B6%E5%88%86%E5%AD%90%E7%9A%84%E8%A1%A8%E9%9D%A2%E9%9D%99%E7%94%B5%E5%8A%BF%E5%9B%BE/"
                            aria-label=": 使用Multiwfn+VMD绘制分子的表面静电势图(ESP)"
                        >
                            使用Multiwfn+VMD绘制分子的表面静电势图(ESP)
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-30T20:12:02+08:00">
	
		    May 30, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/first-stage/">first stage</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <ul>
<li>Multiwfn版本：3.8(dev)，Last update: 2025-May-5</li>
<li>VMD版本：1.9.3</li>
</ul>
<p><strong>VMD版本请尽可能使用1.9.3而不要使用bug较多的1.9.4</strong></p>
<p>本文参考了<a target="_blank" rel="noopener" href="http://sobereva.com/443">Sob老师的博文</a></p>
<h2 id="目标分子的结构优化">目标分子的结构优化</h2>
<p>本次的目标分子为二茂铁分子</p>
<figure>
<img src="1.png" alt="优化完成的二茂铁分子" />
<figcaption aria-hidden="true">优化完成的二茂铁分子</figcaption>
</figure>
<p>首先建立二茂铁分子的模型，并且手动设置全重叠的D5d点群，<strong>这样可以极大的减少优化用时</strong>，关键词如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#p tpssh/def2tzvp opt freq</span><br></pre></td></tr></table></figure>
<p>体系是过渡金属配合物，因此选择tpssh泛函，由于初猜结构比较合适，算得还是挺快的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">                                   -- CHARLES MCCARRY IN &quot;THE GREAT SOUTHWEST&quot;</span><br><span class="line">Job cpu time:       0 days  1 hours 57 minutes 15.2 seconds.</span><br><span class="line">Elapsed time:       0 days  0 hours  5 minutes 58.7 seconds.</span><br><span class="line">File lengths (MBytes):  RWF=    147 Int=      0 D2E=      0 Chk=     16 Scr=      1</span><br><span class="line">Normal termination of Gaussian 16 at Wed May 28 21:43:45 2025.</span><br></pre></td></tr></table></figure>
<p>如下图，优化完成，没有虚频</p>
<figure>
<img src="image-20250530202918054.png" alt="频率正常，无虚频" />
<figcaption aria-hidden="true">频率正常，无虚频</figcaption>
</figure>
<h2 id="绘图前的准备工作">绘图前的准备工作</h2>
<p>如Sob老师所说，绘图之前用户要做的事包括：</p>
<ol type="1">
<li>把examples.txt和.bat文件拷到Multiwfn可执行文件所在目录</li>
<li>把.bat文件里的VMD路径改成实际路径</li>
<li>把examples.vmd拷到VMD路径下</li>
<li>在vmd.rc里加入上述proc语句</li>
</ol>
<h2 id="画图">画图</h2>
<p>有两种风格的分子表面静电势图(ESP)，分别是<strong>表面顶点着色方式</strong>和<strong>电子密度等值面着色方式</strong>的ESP图，我个人更喜欢后者，以后者为例画图吧。</p>
<p>首先运行<code>ESPiso.bat</code>产生电子密度和静电势的cube文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Multiwfn_3.8_dev_bin_Win64&gt; ls</span><br><span class="line"></span><br><span class="line">    Directory: C:\Multiwfn_3.8_dev_bin_Win64</span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d----           2025/5/15    12:20                examples</span><br><span class="line">-a---           2025/5/23     9:20        8114156 1.fch</span><br><span class="line">-a---           2024/9/21    17:46           3057 使用Multiwfn发表文章必须在正文里进行引用（包括代算）.txt</span><br><span class="line">-a---           2025/5/28    17:51            105 ESPext.bat</span><br><span class="line">-a---           2018/10/7     5:24             32 ESPext.txt</span><br><span class="line">-a---           2025/5/28    17:51            460 ESPiso.bat</span><br><span class="line">-a---          2021/11/18    10:43             26 ESPiso.txt</span><br><span class="line">-a---           2025/5/28    17:51            344 ESPpt.bat</span><br><span class="line">-a---           2018/9/30    13:53             29 ESPpt.txt</span><br><span class="line">-a---            2025/2/9     9:28         200205 How to cite Multiwfn.pdf</span><br><span class="line">-a---            2023/3/2     2:26        2047000 libiomp5md.dll</span><br><span class="line">-a---           2024/8/27    20:00           1254 LICENSE.txt</span><br><span class="line">-a---           2025/4/13     9:17         416416 Multiwfn quick start.pdf</span><br><span class="line">-a---            2025/5/5     2:50       35666432 Multiwfn.exe</span><br><span class="line">-a---           2025/5/16     1:26          20490 settings.ini</span><br><span class="line"></span><br><span class="line">PS C:\Multiwfn_3.8_dev_bin_Win64&gt; .\ESPiso.bat</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;Multiwfn 1.fch -ESPrhoiso 0.001  0&lt;ESPiso.txt</span><br><span class="line"> Multiwfn -- A Multifunctional Wavefunction Analyzer</span><br><span class="line"> Version 3.8(dev), update date: 2025-May-5</span><br><span class="line"> Developer: Tian Lu (Beijing Kein Research Center for Natural Sciences)</span><br><span class="line"> Multiwfn official website: http://sobereva.com/multiwfn</span><br><span class="line"> Multiwfn English forum: http://sobereva.com/wfnbbs</span><br><span class="line"> Multiwfn Chinese forum: http://bbs.keinsci.com/wfn</span><br><span class="line"> ( Number of parallel threads:   4  Current date: 2025-05-30  Time: 20:33:12 )</span><br><span class="line"></span><br><span class="line"> Both following papers ***MUST BE CITED IN MAIN TEXT*** if Multiwfn is used:</span><br><span class="line">  Tian Lu, Feiwu Chen, J. Comput. Chem., 33, 580 (2012) DOI: 10.1002/jcc.22885</span><br><span class="line">  Tian Lu, J. Chem. Phys., 161, 082503 (2024) DOI: 10.1063/5.0216272</span><br><span class="line"> See &quot;How to cite Multiwfn.pdf&quot; in Multiwfn binary package for more information</span><br><span class="line"></span><br><span class="line"> Please wait...</span><br><span class="line"> Loading various information of the wavefunction</span><br><span class="line"> The highest angular moment basis functions is F</span><br><span class="line"> Loading basis set definition...</span><br><span class="line"> Loading orbitals...</span><br><span class="line"> Converting basis function information to GTF information...</span><br><span class="line"> Back converting basis function information from Cartesian to spherical type...</span><br><span class="line"> Generating density matrix based on SCF orbitals...</span><br><span class="line"> Generating overlap matrix...</span><br><span class="line"></span><br><span class="line"> Total/Alpha/Beta electrons:     98.0000     49.0000     49.0000</span><br><span class="line"> Net charge:     0.00000      Expected multiplicity:    1</span><br><span class="line"> Atoms:     23,  Basis functions:    427,  GTFs:    708</span><br><span class="line"> Total energy:   -1651.955643142885 Hartree,   Virial ratio:  2.00246837</span><br><span class="line"> This is a restricted single-determinant wavefunction</span><br><span class="line"> Orbitals from 1 to    49 are occupied</span><br><span class="line"> Title line of this file: Generated by autoGau.</span><br><span class="line"></span><br><span class="line"> Loaded 1.fch successfully!</span><br><span class="line"></span><br><span class="line"> Formula: H12 C10 Fe1      Total atoms:      23</span><br><span class="line"> Molecule weight:       188.04779 Da</span><br><span class="line"> Point group: C1</span><br><span class="line"></span><br><span class="line"> &quot;q&quot;: Exit program gracefully          &quot;r&quot;: Load a new file</span><br><span class="line">                    ************ Main function menu ************</span><br><span class="line"> 0 Show molecular structure and view orbitals</span><br><span class="line"> 1 Output all properties at a point       2 Topology analysis</span><br><span class="line"> 3 Output and plot specific property in a line</span><br><span class="line"> 4 Output and plot specific property in a plane</span><br><span class="line"> 5 Output and plot specific property within a spatial region (calc. grid data)</span><br><span class="line"> 6 Check &amp; modify wavefunction</span><br><span class="line"> 7 Population analysis and calculation of atomic charges</span><br><span class="line"> 8 Orbital composition analysis           9 Bond order analysis</span><br><span class="line"> 10 Plot total DOS, PDOS, OPDOS, local DOS, COHP and photoelectron spectrum</span><br><span class="line"> 11 Plot IR/Raman/UV-Vis/ECD/VCD/ROA/NMR spectrum</span><br><span class="line"> 12 Quantitative analysis of molecular surface</span><br><span class="line"> 13 Process grid data (No grid data is presented currently)</span><br><span class="line"> 14 Adaptive natural density partitioning (AdNDP) analysis</span><br><span class="line"> 15 Fuzzy atomic space analysis</span><br><span class="line"> 16 Charge decomposition analysis (CDA) and plot orbital interaction diagram</span><br><span class="line"> 17 Basin analysis                       18 Electron excitation analysis</span><br><span class="line"> 19 Orbital localization analysis        20 Visual study of weak interaction</span><br><span class="line"> 21 Energy decomposition analysis        22 Conceptual DFT (CDFT) analysis</span><br><span class="line"> 23 ETS-NOCV analysis                    24 (Hyper)polarizability analysis</span><br><span class="line"> 25 Electron delocalization and aromaticity analyses</span><br><span class="line"> 26 Structure and geometry related analyses</span><br><span class="line"> 100 Other functions (Part 1)            200 Other functions (Part 2)</span><br><span class="line"> 300 Other functions (Part 3)</span><br><span class="line"> -10 Return to main menu</span><br><span class="line"> -2 Obtain deformation property</span><br><span class="line"> -1 Obtain promolecule property</span><br><span class="line"> 0 Set custom operation</span><br><span class="line">             ----------- Available real space functions -----------</span><br><span class="line"> 1 Electron density (rho)     2 Gradient norm of rho     3 Laplacian of rho</span><br><span class="line"> 4 Value of orbital wavefunction         44 Orbital probability density</span><br><span class="line"> 5 Electron spin density</span><br><span class="line"> 6 Hamiltonian kinetic energy density K(r)</span><br><span class="line"> 7 Lagrangian kinetic energy density G(r)</span><br><span class="line"> 8 Electrostatic potential from nuclear charges</span><br><span class="line"> 9 Electron localization function (ELF)</span><br><span class="line"> 10 Localized orbital locator (LOL)</span><br><span class="line"> 11 Local information entropy</span><br><span class="line"> 12 Total electrostatic potential (ESP)</span><br><span class="line"> 13 Reduced density gradient (RDG)       14 RDG with promolecular approximation</span><br><span class="line"> 15 Sign(lambda2)*rho      16 Sign(lambda2)*rho with promolecular approximation</span><br><span class="line"> 17 Correlation hole for alpha, ref. point:   0.00000   0.00000   0.00000</span><br><span class="line"> 18 Average local ionization energy (ALIE)</span><br><span class="line"> 19 Source function, mode: 1, ref. point:   0.00000   0.00000   0.00000</span><br><span class="line"> 20 Electron delocal. range func. EDR(r;d)  21 Orbital overlap dist. func. D(r)</span><br><span class="line"> 22 Delta-g (promolecular approximation)    23 Delta-g (Hirshfeld partition)</span><br><span class="line"> 24 Interaction region indicator (IRI)    25 van der Waals potential (probe=C )</span><br><span class="line"> 100 User-defined function (iuserfunc=   -1), see Section 2.7 of manual</span><br><span class="line"></span><br><span class="line"> Please select a method to set up grid</span><br><span class="line"> -10 Set extension distance of grid range for mode 1~4, current:  6.000 Bohr</span><br><span class="line"> 1 Low quality grid,    covering whole system, about 125000 points in total</span><br><span class="line"> 2 Medium quality grid, covering whole system, about 512000 points in total</span><br><span class="line"> 3 High quality grid,   covering whole system, about 1728000 points in total</span><br><span class="line"> 4 Input the number of points or grid spacing in X,Y,Z, covering whole system</span><br><span class="line"> 5 Input original point, grid spacings, and the number of points</span><br><span class="line"> 6 Input center coordinate, number of points and extension distance</span><br><span class="line"> 7 The same as 6, but input two atoms, the midpoint will be defined as center</span><br><span class="line"> 8 Use grid setting of another cube file</span><br><span class="line"> 10 Set box of grid data visually using a GUI window</span><br><span class="line"> 11 Select a set of atoms, set extension distance around them and grid spacing</span><br><span class="line"> 100 Load a set of points from external file</span><br><span class="line"> Coordinate of origin in X,Y,Z is     -12.142516  -10.564851  -10.153107 Bohr</span><br><span class="line"> Coordinate of end point in X,Y,Z is   11.971265   10.285411   10.334542 Bohr</span><br><span class="line"> Grid spacing in X,Y,Z is    0.181307    0.181307    0.181307 Bohr</span><br><span class="line"> Number of points in X,Y,Z is  134  116  114   Total:     1772016</span><br><span class="line"> Note: Virtual orbitals higher than LUMO+9 have been temporarily discarded for saving computational time</span><br><span class="line"></span><br><span class="line"> Note: All exponential functions exp(x) with x&lt; -40.000 will be ignored</span><br><span class="line"> Unique GTFs have been constructed. Number of unique GTFs:     708</span><br><span class="line"> Progress: [##################################################]   100.0 %     \</span><br><span class="line"> Calculation of grid data took up wall clock time         4 s</span><br><span class="line"> Note: Previous orbital information has been restored</span><br><span class="line"></span><br><span class="line"> Electric dipole moment estimated by integrating electron density</span><br><span class="line"> X component:          0.281807 a.u.      0.716283 Debye</span><br><span class="line"> Y component:         -0.255113 a.u.     -0.648432 Debye</span><br><span class="line"> Z component:          0.140547 a.u.      0.357235 Debye</span><br><span class="line"> Total magnitude:      0.405279 a.u.      1.030117 Debye</span><br><span class="line"></span><br><span class="line"> The minimum is  0.60334894E-17 at -12.14252 -10.56485  10.33454 Bohr</span><br><span class="line"> The maximum is  0.95394143E+03 at   0.00503   0.13224   0.00006 Bohr</span><br><span class="line"> Summing up all value and multiply differential element:</span><br><span class="line">   100.725159050150</span><br><span class="line"> Summing up positive value and multiply differential element:</span><br><span class="line">   100.725159050150</span><br><span class="line"> Summing up negative value and multiply differential element:</span><br><span class="line">  0.000000000000000E+000</span><br><span class="line"></span><br><span class="line">                   ---------- Post-processing menu ----------</span><br><span class="line"> -1 Show isosurface graph</span><br><span class="line"> 0 Return to main menu</span><br><span class="line"> 1 Save graph of isosurface to file in current folder</span><br><span class="line"> 2 Export data to a Gaussian-type cube file in current folder</span><br><span class="line"> 3 Export data to output.txt in current folder</span><br><span class="line"> 4 Set the value of isosurface to be shown, current:   0.05000</span><br><span class="line"> 5 Multiply all grid data by a factor</span><br><span class="line"> 6 Divide all grid data by a factor</span><br><span class="line"> 7 Add a value to all grid data</span><br><span class="line"> 8 Substract a value from all grid data</span><br><span class="line"> 9 Multiply all grid data by Hirshfeld weights of a fragment (can be used to only make isosurface around interested fragment visible)</span><br><span class="line"> Exporting cube file, please wait...</span><br><span class="line"> Done! Grid data has been exported to density.cub in current folder</span><br><span class="line"> Hint: If you want to add input file name as prefix of the outputted cube file, you can set &quot;iaddprefix&quot; in settings.ini to 1</span><br><span class="line"></span><br><span class="line">                   ---------- Post-processing menu ----------</span><br><span class="line"> -1 Show isosurface graph</span><br><span class="line"> 0 Return to main menu</span><br><span class="line"> 1 Save graph of isosurface to file in current folder</span><br><span class="line"> 2 Export data to a Gaussian-type cube file in current folder</span><br><span class="line"> 3 Export data to output.txt in current folder</span><br><span class="line"> 4 Set the value of isosurface to be shown, current:   0.05000</span><br><span class="line"> 5 Multiply all grid data by a factor</span><br><span class="line"> 6 Divide all grid data by a factor</span><br><span class="line"> 7 Add a value to all grid data</span><br><span class="line"> 8 Substract a value from all grid data</span><br><span class="line"> 9 Multiply all grid data by Hirshfeld weights of a fragment (can be used to only make isosurface around interested fragment visible)</span><br><span class="line"></span><br><span class="line"> Note: A set of grid data is presented in memory</span><br><span class="line"> &quot;q&quot;: Exit program gracefully          &quot;r&quot;: Load a new file</span><br><span class="line">                    ************ Main function menu ************</span><br><span class="line"> 0 Show molecular structure and view orbitals</span><br><span class="line"> 1 Output all properties at a point       2 Topology analysis</span><br><span class="line"> 3 Output and plot specific property in a line</span><br><span class="line"> 4 Output and plot specific property in a plane</span><br><span class="line"> 5 Output and plot specific property within a spatial region (calc. grid data)</span><br><span class="line"> 6 Check &amp; modify wavefunction</span><br><span class="line"> 7 Population analysis and calculation of atomic charges</span><br><span class="line"> 8 Orbital composition analysis           9 Bond order analysis</span><br><span class="line"> 10 Plot total DOS, PDOS, OPDOS, local DOS, COHP and photoelectron spectrum</span><br><span class="line"> 11 Plot IR/Raman/UV-Vis/ECD/VCD/ROA/NMR spectrum</span><br><span class="line"> 12 Quantitative analysis of molecular surface</span><br><span class="line"> 13 Process grid data</span><br><span class="line"> 14 Adaptive natural density partitioning (AdNDP) analysis</span><br><span class="line"> 15 Fuzzy atomic space analysis</span><br><span class="line"> 16 Charge decomposition analysis (CDA) and plot orbital interaction diagram</span><br><span class="line"> 17 Basin analysis                       18 Electron excitation analysis</span><br><span class="line"> 19 Orbital localization analysis        20 Visual study of weak interaction</span><br><span class="line"> 21 Energy decomposition analysis        22 Conceptual DFT (CDFT) analysis</span><br><span class="line"> 23 ETS-NOCV analysis                    24 (Hyper)polarizability analysis</span><br><span class="line"> 25 Electron delocalization and aromaticity analyses</span><br><span class="line"> 26 Structure and geometry related analyses</span><br><span class="line"> 100 Other functions (Part 1)            200 Other functions (Part 2)</span><br><span class="line"> 300 Other functions (Part 3)</span><br><span class="line"> -10 Return to main menu</span><br><span class="line"> -2 Obtain deformation property</span><br><span class="line"> -1 Obtain promolecule property</span><br><span class="line"> 0 Set custom operation</span><br><span class="line">             ----------- Available real space functions -----------</span><br><span class="line"> 1 Electron density (rho)     2 Gradient norm of rho     3 Laplacian of rho</span><br><span class="line"> 4 Value of orbital wavefunction         44 Orbital probability density</span><br><span class="line"> 5 Electron spin density</span><br><span class="line"> 6 Hamiltonian kinetic energy density K(r)</span><br><span class="line"> 7 Lagrangian kinetic energy density G(r)</span><br><span class="line"> 8 Electrostatic potential from nuclear charges</span><br><span class="line"> 9 Electron localization function (ELF)</span><br><span class="line"> 10 Localized orbital locator (LOL)</span><br><span class="line"> 11 Local information entropy</span><br><span class="line"> 12 Total electrostatic potential (ESP)</span><br><span class="line"> 13 Reduced density gradient (RDG)       14 RDG with promolecular approximation</span><br><span class="line"> 15 Sign(lambda2)*rho      16 Sign(lambda2)*rho with promolecular approximation</span><br><span class="line"> 17 Correlation hole for alpha, ref. point:   0.00000   0.00000   0.00000</span><br><span class="line"> 18 Average local ionization energy (ALIE)</span><br><span class="line"> 19 Source function, mode: 1, ref. point:   0.00000   0.00000   0.00000</span><br><span class="line"> 20 Electron delocal. range func. EDR(r;d)  21 Orbital overlap dist. func. D(r)</span><br><span class="line"> 22 Delta-g (promolecular approximation)    23 Delta-g (Hirshfeld partition)</span><br><span class="line"> 24 Interaction region indicator (IRI)    25 van der Waals potential (probe=C )</span><br><span class="line"> 100 User-defined function (iuserfunc=   -1), see Section 2.7 of manual</span><br><span class="line"></span><br><span class="line"> Please select a method to set up grid</span><br><span class="line"> -10 Set extension distance of grid range for mode 1~4, current:  6.000 Bohr</span><br><span class="line"> 1 Low quality grid,    covering whole system, about 125000 points in total</span><br><span class="line"> 2 Medium quality grid, covering whole system, about 512000 points in total</span><br><span class="line"> 3 High quality grid,   covering whole system, about 1728000 points in total</span><br><span class="line"> 4 Input the number of points or grid spacing in X,Y,Z, covering whole system</span><br><span class="line"> 5 Input original point, grid spacings, and the number of points</span><br><span class="line"> 6 Input center coordinate, number of points and extension distance</span><br><span class="line"> 7 The same as 6, but input two atoms, the midpoint will be defined as center</span><br><span class="line"> 8 Use grid setting of another cube file</span><br><span class="line"> 10 Set box of grid data visually using a GUI window</span><br><span class="line"> 11 Select a set of atoms, set extension distance around them and grid spacing</span><br><span class="line"> 100 Load a set of points from external file</span><br><span class="line"> Coordinate of origin in X,Y,Z is     -12.142516  -10.564851  -10.153107 Bohr</span><br><span class="line"> Coordinate of end point in X,Y,Z is   11.789958   10.321672   10.298280 Bohr</span><br><span class="line"> Grid spacing in X,Y,Z is    0.435136    0.435136    0.435136 Bohr</span><br><span class="line"> Number of points in X,Y,Z is   56   49   48   Total:      131712</span><br><span class="line"> Note: Virtual orbitals higher than LUMO+9 have been temporarily discarded for saving computational time</span><br><span class="line"></span><br><span class="line"> Unique GTFs have been constructed. Number of unique GTFs:     708</span><br><span class="line"> Note: ESP will be calculated only for the grids around isosurface of electron density of   0.001000 a.u.</span><br><span class="line"> Detecting the grids for calculating ESP...</span><br><span class="line"> Number of grids to calculate ESP:       10900</span><br><span class="line"></span><br><span class="line"> Initializing LIBRETA library (fast version) for ESP evaluation ...</span><br><span class="line"> LIBRETA library has been successfully initialized!</span><br><span class="line"></span><br><span class="line"> NOTE: The ESP evaluation code based on LIBRETA library is being used. Please cite Multiwfn original papers (J. Comput. Chem., 33, 580-592 (2012) and J. Chem. Phys., 161, 082503 (2024)) and the paper describing the efficient ESP evaluation algorithm adopted by Multiwfn (Phys. Chem. Chem. Phys., 23, 20323 (2021))</span><br><span class="line"> Progress: [##################################################]   100.0 %     \</span><br><span class="line"> Setting ESP of the grids neighbouring to boundary grids...</span><br><span class="line"> Calculation of grid data took up wall clock time        13 s</span><br><span class="line"> Note: Previous orbital information has been restored</span><br><span class="line"></span><br><span class="line"> The minimum is -0.32612104E-01 at  -0.39385  -0.99186   4.64151 Bohr</span><br><span class="line"> The maximum is  0.52214027E-01 at   2.21697  -2.29727  -5.36661 Bohr</span><br><span class="line"> Summing up all value and multiply differential element:</span><br><span class="line">   3.07509251072690</span><br><span class="line"> Summing up positive value and multiply differential element:</span><br><span class="line">   8.67387639395045</span><br><span class="line"> Summing up negative value and multiply differential element:</span><br><span class="line">  -5.59878388322356</span><br><span class="line"></span><br><span class="line">                   ---------- Post-processing menu ----------</span><br><span class="line"> -1 Show isosurface graph</span><br><span class="line"> 0 Return to main menu</span><br><span class="line"> 1 Save graph of isosurface to file in current folder</span><br><span class="line"> 2 Export data to a Gaussian-type cube file in current folder</span><br><span class="line"> 3 Export data to output.txt in current folder</span><br><span class="line"> 4 Set the value of isosurface to be shown, current:   0.05000</span><br><span class="line"> 5 Multiply all grid data by a factor</span><br><span class="line"> 6 Divide all grid data by a factor</span><br><span class="line"> 7 Add a value to all grid data</span><br><span class="line"> 8 Substract a value from all grid data</span><br><span class="line"> 9 Multiply all grid data by Hirshfeld weights of a fragment (can be used to only make isosurface around interested fragment visible)</span><br><span class="line"> Exporting cube file, please wait...</span><br><span class="line"> Done! Grid data has been exported to totesp.cub in current folder</span><br><span class="line"> Hint: If you want to add input file name as prefix of the outputted cube file, you can set &quot;iaddprefix&quot; in settings.ini to 1</span><br><span class="line"></span><br><span class="line">                   ---------- Post-processing menu ----------</span><br><span class="line"> -1 Show isosurface graph</span><br><span class="line"> 0 Return to main menu</span><br><span class="line"> 1 Save graph of isosurface to file in current folder</span><br><span class="line"> 2 Export data to a Gaussian-type cube file in current folder</span><br><span class="line"> 3 Export data to output.txt in current folder</span><br><span class="line"> 4 Set the value of isosurface to be shown, current:   0.05000</span><br><span class="line"> 5 Multiply all grid data by a factor</span><br><span class="line"> 6 Divide all grid data by a factor</span><br><span class="line"> 7 Add a value to all grid data</span><br><span class="line"> 8 Substract a value from all grid data</span><br><span class="line"> 9 Multiply all grid data by Hirshfeld weights of a fragment (can be used to only make isosurface around interested fragment visible)</span><br><span class="line">forrtl: severe (24): end-of-file during read, unit -4, file CONIN$</span><br><span class="line">Image              PC                Routine            Line        Source</span><br><span class="line">Multiwfn.exe       00007FF60135CEB4  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF600F5B65C  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF60127BDD6  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601CCFB7B  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601FE53F0  Unknown               Unknown  Unknown</span><br><span class="line">KERNEL32.DLL       00007FF9259B7374  Unknown               Unknown  Unknown</span><br><span class="line">ntdll.dll          00007FF92667CC91  Unknown               Unknown  Unknown</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y density.cub density1.cub</span><br><span class="line">移动了         1 个文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y totesp.cub ESP1.cub</span><br><span class="line">移动了         1 个文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;Multiwfn 2.fch -ESPrhoiso 0.001  0&lt;ESPiso.txt</span><br><span class="line"> Error: Unable to find the input file you specified in argument</span><br><span class="line"></span><br><span class="line"> Multiwfn -- A Multifunctional Wavefunction Analyzer</span><br><span class="line"> Version 3.8(dev), update date: 2025-May-5</span><br><span class="line"> Developer: Tian Lu (Beijing Kein Research Center for Natural Sciences)</span><br><span class="line"> Multiwfn official website: http://sobereva.com/multiwfn</span><br><span class="line"> Multiwfn English forum: http://sobereva.com/wfnbbs</span><br><span class="line"> Multiwfn Chinese forum: http://bbs.keinsci.com/wfn</span><br><span class="line"> ( Number of parallel threads:   4  Current date: 2025-05-30  Time: 20:33:30 )</span><br><span class="line"></span><br><span class="line"> Both following papers ***MUST BE CITED IN MAIN TEXT*** if Multiwfn is used:</span><br><span class="line">  Tian Lu, Feiwu Chen, J. Comput. Chem., 33, 580 (2012) DOI: 10.1002/jcc.22885</span><br><span class="line">  Tian Lu, J. Chem. Phys., 161, 082503 (2024) DOI: 10.1063/5.0216272</span><br><span class="line"> See &quot;How to cite Multiwfn.pdf&quot; in Multiwfn binary package for more information</span><br><span class="line"></span><br><span class="line"> Now input file path, for example, E:\Planetarian\Yumemi_Hoshino.mwfn</span><br><span class="line"> (.wfn/wfn/wfx/fch/molden/pdb/xyz/mol2/cif/cub... see Section 2.5 of manual)</span><br><span class="line"> Hint: Pressing ENTER button directly can select a file in a GUI window. To reload the past file, inputting &quot;o&quot;. Input such as ?miku.fch can open the miku.fch in the same folder as the past file</span><br><span class="line">&quot;5&quot; cannot be found, input again</span><br><span class="line">&quot;1&quot; cannot be found, input again</span><br><span class="line">&quot;3&quot; cannot be found, input again</span><br><span class="line">&quot;2&quot; cannot be found, input again</span><br><span class="line">&quot;0&quot; cannot be found, input again</span><br><span class="line">&quot;5&quot; cannot be found, input again</span><br><span class="line">&quot;12&quot; cannot be found, input again</span><br><span class="line">&quot;1&quot; cannot be found, input again</span><br><span class="line">&quot;2&quot; cannot be found, input again</span><br><span class="line">forrtl: severe (24): end-of-file during read, unit -4, file CONIN$</span><br><span class="line">Image              PC                Routine            Line        Source</span><br><span class="line">Multiwfn.exe       00007FF601370B01  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF60127CBB3  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601CCFB7B  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601FE53F0  Unknown               Unknown  Unknown</span><br><span class="line">KERNEL32.DLL       00007FF9259B7374  Unknown               Unknown  Unknown</span><br><span class="line">ntdll.dll          00007FF92667CC91  Unknown               Unknown  Unknown</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y density.cub density2.cub</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y totesp.cub ESP2.cub</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;Multiwfn 3.fch -ESPrhoiso 0.001  0&lt;ESPiso.txt</span><br><span class="line"> Error: Unable to find the input file you specified in argument</span><br><span class="line"></span><br><span class="line"> Multiwfn -- A Multifunctional Wavefunction Analyzer</span><br><span class="line"> Version 3.8(dev), update date: 2025-May-5</span><br><span class="line"> Developer: Tian Lu (Beijing Kein Research Center for Natural Sciences)</span><br><span class="line"> Multiwfn official website: http://sobereva.com/multiwfn</span><br><span class="line"> Multiwfn English forum: http://sobereva.com/wfnbbs</span><br><span class="line"> Multiwfn Chinese forum: http://bbs.keinsci.com/wfn</span><br><span class="line"> ( Number of parallel threads:   4  Current date: 2025-05-30  Time: 20:33:30 )</span><br><span class="line"></span><br><span class="line"> Both following papers ***MUST BE CITED IN MAIN TEXT*** if Multiwfn is used:</span><br><span class="line">  Tian Lu, Feiwu Chen, J. Comput. Chem., 33, 580 (2012) DOI: 10.1002/jcc.22885</span><br><span class="line">  Tian Lu, J. Chem. Phys., 161, 082503 (2024) DOI: 10.1063/5.0216272</span><br><span class="line"> See &quot;How to cite Multiwfn.pdf&quot; in Multiwfn binary package for more information</span><br><span class="line"></span><br><span class="line"> Now input file path, for example, E:\Planetarian\Yumemi_Hoshino.mwfn</span><br><span class="line"> (.wfn/wfn/wfx/fch/molden/pdb/xyz/mol2/cif/cub... see Section 2.5 of manual)</span><br><span class="line"> Hint: Pressing ENTER button directly can select a file in a GUI window. To reload the past file, inputting &quot;o&quot;. Input such as ?miku.fch can open the miku.fch in the same folder as the past file</span><br><span class="line">&quot;5&quot; cannot be found, input again</span><br><span class="line">&quot;1&quot; cannot be found, input again</span><br><span class="line">&quot;3&quot; cannot be found, input again</span><br><span class="line">&quot;2&quot; cannot be found, input again</span><br><span class="line">&quot;0&quot; cannot be found, input again</span><br><span class="line">&quot;5&quot; cannot be found, input again</span><br><span class="line">&quot;12&quot; cannot be found, input again</span><br><span class="line">&quot;1&quot; cannot be found, input again</span><br><span class="line">&quot;2&quot; cannot be found, input again</span><br><span class="line">forrtl: severe (24): end-of-file during read, unit -4, file CONIN$</span><br><span class="line">Image              PC                Routine            Line        Source</span><br><span class="line">Multiwfn.exe       00007FF601370B01  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF60127CBB3  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601CCFB7B  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601FE53F0  Unknown               Unknown  Unknown</span><br><span class="line">KERNEL32.DLL       00007FF9259B7374  Unknown               Unknown  Unknown</span><br><span class="line">ntdll.dll          00007FF92667CC91  Unknown               Unknown  Unknown</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y density.cub density3.cub</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y totesp.cub ESP3.cub</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;Multiwfn 4.fch -ESPrhoiso 0.001  0&lt;ESPiso.txt</span><br><span class="line"> Error: Unable to find the input file you specified in argument</span><br><span class="line"></span><br><span class="line"> Multiwfn -- A Multifunctional Wavefunction Analyzer</span><br><span class="line"> Version 3.8(dev), update date: 2025-May-5</span><br><span class="line"> Developer: Tian Lu (Beijing Kein Research Center for Natural Sciences)</span><br><span class="line"> Multiwfn official website: http://sobereva.com/multiwfn</span><br><span class="line"> Multiwfn English forum: http://sobereva.com/wfnbbs</span><br><span class="line"> Multiwfn Chinese forum: http://bbs.keinsci.com/wfn</span><br><span class="line"> ( Number of parallel threads:   4  Current date: 2025-05-30  Time: 20:33:30 )</span><br><span class="line"></span><br><span class="line"> Both following papers ***MUST BE CITED IN MAIN TEXT*** if Multiwfn is used:</span><br><span class="line">  Tian Lu, Feiwu Chen, J. Comput. Chem., 33, 580 (2012) DOI: 10.1002/jcc.22885</span><br><span class="line">  Tian Lu, J. Chem. Phys., 161, 082503 (2024) DOI: 10.1063/5.0216272</span><br><span class="line"> See &quot;How to cite Multiwfn.pdf&quot; in Multiwfn binary package for more information</span><br><span class="line"></span><br><span class="line"> Now input file path, for example, E:\Planetarian\Yumemi_Hoshino.mwfn</span><br><span class="line"> (.wfn/wfn/wfx/fch/molden/pdb/xyz/mol2/cif/cub... see Section 2.5 of manual)</span><br><span class="line"> Hint: Pressing ENTER button directly can select a file in a GUI window. To reload the past file, inputting &quot;o&quot;. Input such as ?miku.fch can open the miku.fch in the same folder as the past file</span><br><span class="line">&quot;5&quot; cannot be found, input again</span><br><span class="line">&quot;1&quot; cannot be found, input again</span><br><span class="line">&quot;3&quot; cannot be found, input again</span><br><span class="line">&quot;2&quot; cannot be found, input again</span><br><span class="line">&quot;0&quot; cannot be found, input again</span><br><span class="line">&quot;5&quot; cannot be found, input again</span><br><span class="line">&quot;12&quot; cannot be found, input again</span><br><span class="line">&quot;1&quot; cannot be found, input again</span><br><span class="line">&quot;2&quot; cannot be found, input again</span><br><span class="line">forrtl: severe (24): end-of-file during read, unit -4, file CONIN$</span><br><span class="line">Image              PC                Routine            Line        Source</span><br><span class="line">Multiwfn.exe       00007FF601370B01  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF60127CBB3  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601CCFB7B  Unknown               Unknown  Unknown</span><br><span class="line">Multiwfn.exe       00007FF601FE53F0  Unknown               Unknown  Unknown</span><br><span class="line">KERNEL32.DLL       00007FF9259B7374  Unknown               Unknown  Unknown</span><br><span class="line">ntdll.dll          00007FF92667CC91  Unknown               Unknown  Unknown</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y density.cub density4.cub</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y totesp.cub ESP4.cub</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"></span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64&gt;move /Y *.cub &quot;C:\VMD&quot;</span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64\density1.cub</span><br><span class="line">C:\Multiwfn_3.8_dev_bin_Win64\ESP1.cub</span><br><span class="line">移动了         2 个文件。</span><br></pre></td></tr></table></figure>
<p>然后打开<code>VMD</code>软件，输入<code>iso</code>即可画图</p>
<figure>
<img src="image-20250530203615609.png"
alt="根据电荷等值面着色的ESP图" />
<figcaption aria-hidden="true">根据电荷等值面着色的ESP图</figcaption>
</figure>
<p>再输入<code>ext</code>即可显示极值点</p>
<figure>
<img src="image-20250530203724559.png" alt="包含极值点的ESP图" />
<figcaption aria-hidden="true">包含极值点的ESP图</figcaption>
</figure>
<p>上图中的材质已被我改为<code>transparent</code>，因此能看到背面的极值点，修改方法可以通过<code>Grapgics-Materials</code>进行修改，然而答主修改时没有任何变化，于是在<code>ESPiso.vmd</code>中直接将<code>EdgyGlass</code>改成了<code>Transparent</code></p>
<p>怎么添加刻度呢？操作如下图</p>
<figure>
<img src="image-20250530205133881.png" alt="image-20250530205133881" />
<figcaption aria-hidden="true">image-20250530205133881</figcaption>
</figure>
<p>接下来是自定义图片的导出，<code>File-Render</code>，渲染器选择<code>Tachyon</code>，开始渲染，然后在<code>VMD</code>的根目录下得到了文件<code>vmdscene.dat</code>，接下来调用渲染器进行渲染，渲染的<code>.bat</code>脚本是：</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tachyon_WIN32.exe vmdscene.dat -aasamples <span class="number">24</span> -mediumshade -trans_vmd -res <span class="number">1024</span> <span class="number">768</span> -<span class="built_in">format</span> BMP -o vmdscene.bmp</span><br></pre></td></tr></table></figure>
<p>其中的1024是长，768是宽，可以改成想要的分辨率</p>
<figure>
<img src="Ferocene.jpg" alt="二茂铁的ESP图像" />
<figcaption aria-hidden="true">二茂铁的ESP图像</figcaption>
</figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/30/%E9%87%8F%E5%AD%90%E5%8C%96%E5%AD%A6/%E4%BD%BF%E7%94%A8Multiwfn+VMD%E7%BB%98%E5%88%B6%E5%88%86%E5%AD%90%E7%9A%84%E8%A1%A8%E9%9D%A2%E9%9D%99%E7%94%B5%E5%8A%BF%E5%9B%BE/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/27/%E7%A7%91%E7%A0%94/first%20stage/%E7%94%B5%E5%8C%96%E5%AD%A6%E9%98%BB%E6%8A%97%E8%B0%B1/"
                            aria-label=": 从零开始的电化学阻抗谱原理"
                        >
                            从零开始的电化学阻抗谱原理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-27T20:13:00+08:00">
	
		    May 27, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/first-stage/">first stage</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="什么是电化学阻抗谱">什么是电化学阻抗谱？</h2>
<p>有一种叫做<strong>黑箱</strong>的未知特性系统。可采用一系列测量方法，通过施加输入信号并检测输出响应来探查黑箱。例如，假设将黑箱置于暗室中，然后施加特定波长的光照。若观察到响应信号（如电流），则可判定箱内物质具有光活性。输入与输出之间的关系称为“传递函数”，阻抗谱是传递函数的一种特例。</p>
<p>阻抗：电路中电阻、电感、电容对交流电个阻碍作用个统称。阻抗是一个复数，实部称为电阻，虚部称为电抗。电化学过程主要涉及电荷在电极和电解质界面上的传输和存储。例如，电极表面的双电层效应会形成双电层电容，电解质中的离子扩散也会导致电容行为。这些机制使电容成为电化学系统中主要的电抗元件。
相比之下，电感通常与磁场的变化相关，比如电流通过线圈时产生的磁场。然而，在常规的电化学系统中，磁场变化通常不显著，因此电感的影响非常小，通常电化学系统中考虑电阻、容抗而不考虑感抗。</p>
<p>电化学阻抗谱（EIS）通过施加交流电压（或电流）并测量产生的电流（或电压），能够研究电极和电化学池的电化学特性，利用等效电路进行分析，可以确定与电极电化学反应相关的重要参数，如电荷转移电阻、双电层电容和Warburg阻抗</p>
<h2 id="阻抗的复数表达形式">阻抗的复数表达形式</h2>
<p>交流电（AC）电路中的电流、电压以及阻抗通常使用复数来表示，主要原因有两个：</p>
<ol type="1">
<li>交流信号（以及许多其他正弦波现象）具有一个幅值和一个相位，它们分别与复数的模和幅角非常相似</li>
<li>复数的基本运算，如加法、减法、乘法和除法，更容易执行和编程</li>
</ol>
<p><strong>注意：</strong></p>
<ul>
<li>因为符号<span class="math inline"><em>i</em></span>
在交流电路中用于表示电流，这里我们用<span
class="math inline"><em>j</em></span>作为虚数单位，即<span
class="math inline"><em>j</em><sup>2</sup> = −1</span></li>
<li>符号 <span class="math inline">ℜ<em>e</em></span>代表复数的实部</li>
</ul>
<h3 id="预备知识">预备知识</h3>
<p><strong>复数的标准形式</strong> <span
class="math display"><em>Z</em> = <em>a</em> + <em>b</em><em>j</em></span>
<strong>复数的模</strong> <span class="math display">$$
\lvert Z \rvert =\sqrt {a^2+b^2}
$$</span></p>
<p><strong>欧拉公式</strong> <span
class="math display"><em>e</em><sup><em>i</em><em>x</em></sup> = cos <em>x</em> + <em>i</em>sin <em>x</em></span>
<strong>复数的指数形式</strong> <span
class="math display"><em>Z</em> = <em>r</em><em>e</em><sup><em>j</em><em>θ</em></sup> = <em>r</em>cos <em>θ</em> + <em>r</em><em>j</em>sin <em>θ</em></span>
<strong>取实数部分：</strong> <span
class="math display">ℜ<em>e</em>(<em>r</em><em>e</em><sup><em>j</em><em>θ</em></sup>) = <em>r</em>cos <em>θ</em></span></p>
<p><strong>单变量复函数<span
class="math inline"><em>f</em>(<em>t</em>)</span>的导数的实部等于<span
class="math inline"><em>f</em>(<em>t</em>)</span>的实部的导数，证明如下：</strong>
$$ <span class="math display">$$
**复函数$f(t)$的不定积分的实部等于$f(t)$的实部的不定积分，证明如下**
$$</span> $$</p>
<h3 id="复数形式的阻抗">复数形式的阻抗</h3>
<ul>
<li><strong>电压源</strong></li>
</ul>
<p><span
class="math display"><em>v</em>(<em>t</em>) = <em>V</em><sub>0</sub>cos (<em>ω</em><em>t</em>) = ℜ<em>e</em>(<em>V</em><sub>0</sub>cos (<em>ω</em><em>t</em>) + <em>V</em><sub>0</sub><em>j</em>sin (<em>ω</em><em>t</em>)) = ℜ<em>e</em>(<em>V</em><sub>0</sub><em>e</em><sup><em>j</em><em>ω</em><em>t</em></sup>)</span></p>
<ul>
<li><strong>电阻</strong></li>
</ul>
<p>对于如下图的交变电路</p>
<figure>
<img src="resistor-circuit-1756610307135-1.png"
alt="交变电路中的电阻" />
<figcaption aria-hidden="true">交变电路中的电阻</figcaption>
</figure>
<p>定义<span
class="math inline"><em>Z</em><sub><em>R</em></sub> = <em>R</em></span>，那么电流<span
class="math inline">$i=\Re e(\dfrac{V_R}{R})$</span>或<span
class="math inline">$I=\dfrac{V_R}{Z_R}$</span></p>
<ul>
<li><strong>电容</strong></li>
</ul>
<figure>
<img src="capacitor-circuit-1756610307135-2.png"
alt="交变电路中的电容" />
<figcaption aria-hidden="true">交变电路中的电容</figcaption>
</figure>
<p>电容上电流的定义为：<span class="math inline">$I=C(\dfrac{d
v(t)}{dt})$</span>，则有如下推导： <span class="math display">$$
\begin{align}
v(t)=&amp;\dfrac{1}{C}\int i dt\\
v(t)=&amp;V_0\cos (\omega t)=\Re e(V_0e^{j\omega t})\\
\Re e(V_0e^{j\omega t})=&amp;\dfrac{1}{C}\int idt\\
\dfrac{d}{dt}(\Re e(V_0e^{j\omega
t}))=&amp;\dfrac{d}{dt}(\dfrac{1}{C}\int idt)\\
\Re e(j\omega V_0e^{j\omega t})=&amp;\dfrac{1}{C}i\\
i=&amp;\Re e(j\omega CV_0e^{j\omega t})
\end{align}
$$</span> 电容器C两端的电压为<span
class="math inline"><em>V</em><sub><em>C</em></sub> = <em>V</em><sub>0</sub><em>e</em><sup><em>j</em><em>ω</em><em>t</em></sup></span>，那么电容对电流的阻碍作用<span
class="math inline">$Z_C=\dfrac{1}{j\omega C}=-\dfrac{j}{\omega
C}$</span></p>
<p><strong>与电阻的阻抗（电阻）<span
class="math inline"><em>Z</em><sub><em>R</em></sub></span>不同，电容的阻抗（容抗）<span
class="math inline"><em>Z</em><sub><em>C</em></sub></span>是一个纯虚数</strong></p>
<ul>
<li>电感</li>
</ul>
<p><strong>在电化学系统中，电感并不常见</strong></p>
<figure>
<img src="inductor-circuit-1756610307135-3.png"
alt="交变电路中的电感" />
<figcaption aria-hidden="true">交变电路中的电感</figcaption>
</figure>
<p><strong>电感<span class="math inline"><em>L</em></span>上的电流<span
class="math inline"><em>i</em></span>和电压<span
class="math inline"><em>v</em>(<em>t</em>)</span>之间的关系为：</strong><span
class="math inline">$v(t)=L\dfrac{di}{dt}$</span>，则有： <span
class="math display">$$
\begin{align}
\Re e(V_0e^{j\omega t})=&amp;L\dfrac{di}{dt}\\
\int \Re e(V_0e^{j\omega t})=&amp;\int L\dfrac{di}{dt}dt\\
\Re e(\dfrac{1}{j\omega}V_0e^{j\omega t})=&amp;Li\\
i=&amp;\Re e(\dfrac{1}{j\omega L}V_0e^{j\omega t})
\end{align}
$$</span> 电感的对电流的阻碍作用为：<span
class="math inline"><em>Z</em><sub><em>L</em></sub> = <em>j</em><em>ω</em><em>L</em></span>，<strong>类似的，电感的阻抗（感抗）也是一个纯虚数</strong></p>
<h2 id="交变电路中的电阻和电容">交变电路中的电阻和电容</h2>
<p><strong>电压源为：<span
class="math inline"><em>E</em>(<em>t</em>) = <em>E</em><sub>0</sub>sin (<em>ω</em><em>t</em>)</span></strong></p>
<p>电容表现出与电阻相似的行为，即电压与电流的幅值比恒定，但电流相位相对于外加电压存在-90°偏移:<span
class="math inline">$I=E_0\omega C\sin(\omega
t-\dfrac{\pi}{2})$</span></p>
<figure>
<img src="22-66071fig01RGB-1756610307135-4.jpg"
alt="施加的正弦电压E(t)与(a)电阻和(b)电容中产生的电流(t)之间的关系。" />
<figcaption
aria-hidden="true">施加的正弦电压E(t)与(a)电阻和(b)电容中产生的电流(t)之间的关系。</figcaption>
</figure>
<p>电阻和电容的电流响应可用两个参数表征：</p>
<ul>
<li>阻抗模量<span class="math inline">|<em>Z</em>|</span>
<ul>
<li>电阻：<span
class="math inline">|<em>Z</em><sub><em>R</em></sub>|</span>恒定</li>
<li>电容：<span class="math inline">$\lvert Z_C \rvert=\dfrac{1}\omega
C{}$</span></li>
</ul></li>
<li>电压与电流之间的相位差<span class="math inline"><em>θ</em></span>
<ul>
<li>电阻：<span
class="math inline"><em>θ</em> = 0<sup>∘</sup></span></li>
<li>电容：<span
class="math inline"><em>θ</em> = −90<sup>∘</sup></span></li>
</ul></li>
</ul>
<p><strong>使用阻抗表达式<span
class="math inline"><em>Z</em> = |<em>Z</em>|(cos <em>θ</em> + sin <em>θ</em>)</span>，在交流测量中可以统一处理这两种电路元件</strong></p>
<p>电阻和电容的串联电路比较简单，而并联的情况稍复杂，讨论一下：</p>
<figure>
<img src="22-66071fig02RGB-1756610307135-6.jpg"
alt="施加正弦电压E(t)与并联RC电路响应电流(t)的关系。总电流是流经电阻R(t)和电容C(t)的电流之和" />
<figcaption
aria-hidden="true">施加正弦电压E(t)与并联RC电路响应电流(t)的关系。总电流是流经电阻R(t)和电容C(t)的电流之和</figcaption>
</figure>
<p>总阻抗： <span class="math display">$$
\begin{align}
\dfrac{1}{Z}=&amp;\dfrac{1}{Z'}+\dfrac{1}{Z''}\\
=&amp;\dfrac{1}{R}+j\omega C\\
Z=&amp;\dfrac{1}{\dfrac{1}{R}+j\omega C}\\
=&amp;\dfrac{R}{1+(\omega CR)^2}-\dfrac{\omega CR^2 j}{1+(\omega
CR)^2}\\
\lvert Z \rvert=&amp;\sqrt{Z'^2+Z''^2}\\
=&amp;\dfrac{R}{\sqrt{1+(\omega CR)^2}}
\end{align}
$$</span> <strong>总结一下串联和并联 RC 电路的复阻抗特性：</strong></p>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 20%" />
<col style="width: 15%" />
<col style="width: 19%" />
<col style="width: 22%" />
<col style="width: 16%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><span
class="math inline"><em>Z</em> = <em>Z</em><sup>′</sup> + <em>j</em><em>Z</em><sup>″</sup></span></th>
<th><span
class="math inline"><em>Z</em><sup>′</sup> = |<em>Z</em>|cos <em>θ</em></span></th>
<th><span
class="math inline"><em>Z</em><sup>″</sup> = |<em>Z</em>|sin <em>θ</em></span></th>
<th><span class="math inline">$\lvert Z \rvert
=\sqrt{Z'^2+Z''^2}$</span></th>
<th><span
class="math inline">$\theta=\tan^{-1}\dfrac{Z''}{Z'}$</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>串联RC电路</td>
<td><span class="math inline">$R-\dfrac{j}{\omega C}$</span></td>
<td><span class="math inline"><em>R</em></span></td>
<td><span class="math inline">$-\dfrac{1}{\omega C}$</span></td>
<td><span
class="math inline">$\sqrt{R^2+\dfrac{1}{\omega^2C^2}}$</span></td>
<td><span class="math inline">$\tan^{-1}(-\dfrac{1}{\omega
RC})$</span></td>
</tr>
<tr>
<td>并联RC电路</td>
<td><span class="math inline">$(\dfrac{1}{R}-\dfrac{\omega
C}{j})^{-1}$</span></td>
<td><span class="math inline">$\dfrac{R}{(\omega RC)^2+1}$</span></td>
<td><span class="math inline">$\dfrac{-\omega R^2C}{(\omega
RC)^2+1}$</span></td>
<td><span
class="math inline">$\dfrac{1}{\sqrt{\dfrac{1}{R^2}+\omega^2C^2}}$</span></td>
<td><span
class="math inline">tan<sup>−1</sup>(<em>ω</em><em>R</em><em>C</em>)</span></td>
</tr>
</tbody>
</table>
<h2 id="阻抗的图解">阻抗的图解</h2>
<p>如上所述，阻抗<span
class="math inline"><em>Z</em></span>既可用阻抗模值<span
class="math inline">|<em>Z</em>(<em>ω</em>)|</span>和相位角<span
class="math inline"><em>θ</em>(<em>ω</em>)</span>表示，也可用阻抗的实部<span
class="math inline"><em>Z</em><sup>′</sup>(<em>ω</em>)</span>和虚部<span
class="math inline"><em>Z</em><sup>″</sup>(<em>ω</em>)</span>表示，分别对应两种图：Bode图和Nyquist图</p>
<figure>
<img src="22-66071fig03-1756610307135-5.jpg"
alt="(a)串联与(b)并联 RC 电路的波特图。虚线标示频率 f = 1/(2πRC)处相位角θ = −45°的位置。" />
<figcaption aria-hidden="true">(a)串联与(b)并联 RC
电路的波特图。虚线标示频率 f = 1/(2πRC)处相位角θ =
−45°的位置。</figcaption>
</figure>
<figure>
<img src="22-66071fig04-1756610307135-7.jpg"
alt="(a)串联与(b)并联 RC 电路的Nyquist图。虚线标示频率 f=1/(2πRC)对应的相位角θ=-45°位置。" />
<figcaption aria-hidden="true">(a)串联与(b)并联 RC
电路的Nyquist图。虚线标示频率
f=1/(2πRC)对应的相位角θ=-45°位置。</figcaption>
</figure>
<p>串联RC电路的阻抗是<span
class="math inline"><em>Z</em><sub><em>R</em></sub></span>与<span
class="math inline"><em>Z</em><sub><em>C</em></sub></span>之和。因此在高频区，由于<span
class="math inline"><em>Z</em><sub><em>R</em></sub> ≫ <em>Z</em><sub><em>C</em></sub></span>
，电路阻抗等于电阻R；而在低频区，由于<span
class="math inline"><em>Z</em><sub><em>R</em></sub> ≪ <em>Z</em><sub><em>C</em></sub></span>
，阻抗等于<span
class="math inline"><em>Z</em><sub><em>C</em></sub></span>
。如Bode图所示，串联RC电路在高频区表现为电阻特性（|Z|与频率无关，相位角θ为
0°），在低频区表现为电容特性（|Z|与频率成反比，相位角θ为−90°）。Nyquist图中，串联
RC 电路的阻抗轨迹为一条从实轴垂直延伸的直线，与实轴交点的值等于
R。该电路的时间常数为RC，意味着当频率<span
class="math inline">$ω=\dfrac{1}{RC}$</span>时，<span
class="math inline">|<em>Z</em><sub><em>R</em></sub>| = |<em>Z</em><sub><em>C</em></sub>|</span>且相位角<span
class="math inline"><em>θ</em> = −45°</span></p>
<p>并联RC电路的阻抗Z通过公式<span
class="math inline">$\frac{1}{Z}=\frac{1}{Z_R}+\frac{1}{Z_C}$</span>计算。因此，并联
RC 电路，阻抗较小的电路元件特性会显现。在高频区，并联RC电路的Z 等于<span
class="math inline"><em>Z</em><sub><em>C</em></sub></span>
；而在低频区则等于<span
class="math inline"><em>Z</em><sub><em>R</em></sub></span>，这与串联RC电路的情况相反。在并联
RC 电路的Nyquist图中，阻抗轨迹 Z 呈现为半圆形，圆弧直径等于
R。该电路的时间常数<span
class="math inline"><em>τ</em> = <em>R</em><em>C</em></span>，与串联电路相同。当频率<span
class="math inline">$\omega =\frac{1}{RC}$</span>时，<span
class="math inline">|<em>Z</em><sub><em>R</em></sub>| = |<em>Z</em><sub><em>C</em></sub>|</span>且相位角<span
class="math inline"><em>θ</em> = −45°</span>，此时对应Nyquist图中圆弧的顶点。</p>
<p>与Bode图相比，Nyquist图更适合通过轨迹形状来辨识电路结构。但需指出的是，当两个并联
RC
电路的时间常数相近时，即便其电阻和电容值不同，它们的半圆也难以区分。如下图所示，当两个并联
RC
电路的时间常数仅相差10倍时，可观察到由两段圆弧重叠形成的畸变半圆。只有当时间常数差异达到
100
倍以上时，两段圆弧才能被清晰区分。因此在构建等效电路时，仅依Nyquist图并不可取，必须验证该等效电路能否合理解释目标电化学现象中的每个基本过程</p>
<figure>
<img src="22-66071fig06RGB-1756610307135-8.jpg"
alt="不同电容值 C 下的电路Nyquist图：(a) C=0.2 毫法，(b) 1 毫法，(c) 5 毫法，(d) 10 毫法。两个并联 RC 电路的时间常数比分别为：(a) 250，(b) 50，(c) 10，(d) 5。" />
<figcaption aria-hidden="true">不同电容值 C 下的电路Nyquist图：(a) C=0.2
毫法，(b) 1 毫法，(c) 5 毫法，(d) 10 毫法。两个并联 RC
电路的时间常数比分别为：(a) 250，(b) 50，(c) 10，(d) 5。</figcaption>
</figure>
<h3
id="下面列举一些常见的电路模型以及相应的nyquistbode图吧">下面列举一些常见的电路模型以及相应的Nyquist、Bode图吧</h3>
<figure>
<img src="images_large_tg2c00070_0008-1756610307135-9.jpeg"
alt="images_large_tg2c00070_0008" />
<figcaption aria-hidden="true">images_large_tg2c00070_0008</figcaption>
</figure>
<ul>
<li>电感的Nyquist图在第四象限</li>
<li>“电阻等价于点”</li>
<li>“电容等价于垂直线”</li>
</ul>
<figure>
<img src="images_large_tg2c00070_0009-1756610307135-10.jpeg"
alt="images_large_tg2c00070_0009" />
<figcaption aria-hidden="true">images_large_tg2c00070_0009</figcaption>
</figure>
<ul>
<li>电容和电阻的并联反映到Nyquist图上即为一个半圆弧</li>
<li>有几个电阻-电容并联电路就有可能出现几个半圆弧</li>
<li>电阻<span
class="math inline">$\rm{R}_0$</span>+电阻-电容并联电路就等价于将半圆弧向右平移<span
class="math inline">$\rm{R_0}$</span>个单位</li>
</ul>
<figure>
<img src="images_large_tg2c00070_0013-1756610307135-11.jpeg"
alt="images_large_tg2c00070_001" />
<figcaption aria-hidden="true">images_large_tg2c00070_001</figcaption>
</figure>
<p>定义法拉第阻抗<span
class="math inline"><em>Z</em><sub><em>f</em></sub> = <em>R</em><sub><em>c</em><em>t</em></sub> + <em>Z</em><sub><em>W</em></sub></span></p>
<ul>
<li>上图左侧为理想高频部分，此时电荷转移电阻<span
class="math inline"><em>R</em><sub><em>c</em><em>t</em></sub></span>很大，阻抗由电荷转移主导</li>
<li>上图右侧为理想低频部分，此时“电容断路（电容特性：通高频阻低频）”，阻抗由物质扩散主导（溶液离子扩散、固体电解质中离子扩散等等）</li>
<li>如果是一个频率非常广泛的、既包含高频又包含低频的电化学阻抗测试，那么Nyquist图中可能同时出现高频部分的半圆弧和低频部分的直线，如下图所示</li>
</ul>
<figure>
<img src="images_large_tg2c00070_0014-1756610307135-12.jpeg"
alt="images_large_tg2c00070_0014" />
<figcaption aria-hidden="true">images_large_tg2c00070_0014</figcaption>
</figure>
<h3 id="电极的等效电路">电极的等效电路</h3>
<p>在电化学阻抗谱（EIS）中，电极的电化学行为通常由包含电阻和电容的等效电路表示。其中，Randles
电路常被用作电极的等效电路模型</p>
<figure>
<img src="22-66071fig07-1756610307135-13.jpg"
alt="Randles的Nyquist图" />
<figcaption aria-hidden="true">Randles的Nyquist图</figcaption>
</figure>
<ul>
<li>定义法拉第阻抗<span
class="math inline"><em>Z</em><sub><em>f</em></sub> = <em>R</em><sub><em>c</em><em>t</em></sub> + <em>Z</em><sub><em>W</em></sub></span></li>
<li>溶液电阻<span
class="math inline"><em>R</em><sub><em>s</em></sub></span>：即使使用参比电极，IR降也不可忽略。电解质传导过程中涉及的电阻称为溶液电阻（<span
class="math inline"><em>R</em><sub><em>s</em></sub></span> ），
可通过Nyquist奎斯特图中高频极限处与实轴的交点获得</li>
<li>电荷转移电阻<span
class="math inline"><em>R</em><sub><em>c</em><em>t</em></sub></span>：当过电位较大时，电极发生极化，过电位与电流之间呈现指数依赖，而当电极电位接近平衡电位时，过电位与电流的指数关系可简化为线性关系。因此，在极低过电位区域（&lt;10
mV）内，电极表现为电阻特性，其电阻值称为电荷转移电阻，对应于Nyquist奎斯特图中半圆的直径。由于电荷转移电阻的概念仅适用于获得线性关系的极小过电位区域，因此电化学阻抗谱中的电压振幅通常设置为≤10
mV。</li>
<li>双电层电容<span
class="math inline"><em>C</em><sub><em>d</em><em>l</em></sub></span>：电极与电解质界面处的电双层类似于电容器，虽然无法直接从Nyquist图中确定<span
class="math inline"><em>C</em><sub><em>d</em><em>l</em></sub></span>
的数值，但如果确定了<span
class="math inline"><em>R</em><sub><em>c</em><em>t</em></sub></span>
，则可通过以下关系式利用圆弧顶点频率对应并联电路的时间常数计算出<span
class="math inline"><em>C</em><sub><em>d</em><em>l</em></sub></span>
：<span
class="math inline"><em>τ</em> = <em>R</em><sub><em>c</em><em>t</em></sub> × <em>C</em><sub><em>d</em><em>l</em></sub></span></li>
<li>Wurburg阻抗：源于电解液中活性物质的扩散过程。在半无限扩散条件下，<span
class="math inline"><em>Z</em><sub><em>W</em></sub></span>可通过以下方程表示：</li>
</ul>
<p><span class="math display">$$
Z_W=\dfrac{RT}{n^2F^2Ac\sqrt{D}}\cdot\dfrac{1}{\sqrt{\omega}}\cdot\dfrac{1-j}{\sqrt{2}}
$$</span></p>
<p>其中，n为反应中转移的电子数，A
为电极的几何面积，c为活性物质的浓度，D为扩散系数。Wurburg阻抗可用一个电容器与电阻器无限级联的电路表示。在Wurburg阻抗中，Z’和-Z’‘相等，因此在Nyquist图中可观察到一条斜率为-45°的直线。通过绘制
Z’和
Z’’随ω变化的关系曲线，可从两条平行直线的斜率确定扩散系数。值得注意的是，该式源自能斯特方程中浓度电势依赖项(<span
class="math inline">$\dfrac{\partial E}{\partial
c}$</span>)。对于不符合能斯特方程的电极（如发生固态扩散的电极），必须考虑(<span
class="math inline">$\dfrac{\partial E}{\partial
c}$</span>)项才能计算扩散系数</p>
<p>如下图所示，当扩散系数 D
增大时，活性物质能快速响应电极表面浓度变化而迅速补充至电极界面。因此较大的
D 值会导致<span
class="math inline"><em>Z</em><sub><em>W</em></sub></span>值减小。反之，<span
class="math inline"><em>Z</em><sub><em>W</em></sub></span>随D值减小而增大，从而使直线向低频方向移动。最终在Bode图中，<span
class="math inline"><em>Z</em><sub><em>W</em></sub></span>的线性区会与并联RC电路引起的|Z|变化区域重叠。这一现象在下下图（😛）所示的Nyquist图中更为明显：当
D 值较大时，-45°斜率的直线与圆弧可清晰区分；但随着 D
值减小，圆弧与直线开始重叠。这种重叠现象表明活性物质的扩散速度低于电荷转移反应的时间常数，本质上意味着扩散过程成为速率控制步骤。</p>
<figure>
<img src="22-66071fig08RGB-1756610307135-14.jpg"
alt="不同 RT/(n2F2AcD^0.5 )值下 Randles电路的 Bode 图：(a) 1, (b) 10, (c) 100, (d) 300 Ω s −0.5" />
<figcaption aria-hidden="true">不同 RT/(n<sup>2F</sup>2AcD^0.5 )值下
Randles电路的 Bode 图：(a) 1, (b) 10, (c) 100, (d) 300 Ω s
−0.5</figcaption>
</figure>
<figure>
<img src="22-66071fig09RGB-1756610307135-15.jpg"
alt="不同 RT/(n2F2AcD^0.5 )值下 Randles电路的Nyquist图：(a) 1, (b) 10, (c) 100, (d) 300 Ω·s −0.5" />
<figcaption aria-hidden="true">不同 RT/(n<sup>2F</sup>2AcD^0.5 )值下
Randles电路的Nyquist图：(a) 1, (b) 10, (c) 100, (d) 300 Ω·s
−0.5</figcaption>
</figure>
<p><strong>一个性能良好的固态电解质材料，其离子电导率应当较大，扩散系数D应当较大，那么Nyquist图应当接近于a或b的形貌</strong></p>
<h3
id="从理想电极到真实电极常相位元件cpe">从理想电极到真实电极——常相位元件CPE</h3>
<p>CPE被定义为： <span class="math display">$$
Z_{CPE}=\dfrac{1}{Y_O(j\omega)^n}
$$</span></p>
<p><span
class="math display"><em>θ</em> = 90<sup>∘</sup>(1 − <em>n</em>)</span></p>
<p>其中θ是与理想情况（φ=90°）的相位偏差，n 是从 0 到 1
的常数，定义了与理想行为的偏差</p>
<table>
<colgroup>
<col style="width: 4%" />
<col style="width: 19%" />
<col style="width: 17%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr>
<th style="text-align: left;">n</th>
<th style="text-align: left;">相位角φ（理想行为）</th>
<th style="text-align: left;">与理想行为的偏差θ</th>
<th style="text-align: left;">阻抗方程</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">90</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;"><span
class="math inline">$Z(\omega)=\dfrac{1}{j\omega
\rm{C_{dl}}}$</span></td>
</tr>
<tr>
<td style="text-align: left;">0.9</td>
<td style="text-align: left;">81</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;"><span
class="math inline">$Z_{\omega}=\dfrac{1}{Y_O(j\omega)^{0.9}}$</span></td>
</tr>
<tr>
<td style="text-align: left;">0.8</td>
<td style="text-align: left;">72</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;"><span
class="math inline">$Z_{\omega}=\dfrac{1}{Y_O(j\omega)^{0.8}}$</span></td>
</tr>
<tr>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">90</td>
<td style="text-align: left;"><span
class="math inline">$Z_{\omega}=\dfrac{1}{Y_O(j\omega)^{0}}=\dfrac{1}{Y_O}=R$</span></td>
</tr>
<tr>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">45</td>
<td style="text-align: left;">45</td>
<td style="text-align: left;"><span
class="math inline">$Z(\omega)=\dfrac{1}{Y_O}\sqrt{j\omega}$</span></td>
</tr>
</tbody>
</table>
<p>两个极端情况：</p>
<ul>
<li>n=1，CPE表现为理想电容器</li>
<li>n=0，CPE 表现为电阻器</li>
<li>n=0.5，<span
class="math inline">$Z(\omega)=\dfrac{1}{Y_O}\sqrt{j\omega}$</span>，即等价于
Warburg 阻抗</li>
</ul>
<h2
id="用传输线模型来直观理解扩散阻抗">用传输线模型来直观理解扩散阻抗</h2>
<p>Warburg阻抗是一个复杂的元素，它表示氧化还原物质向电极表面的质量传递，并被描绘为奈奎斯特图的低频范围上的-45°线。这种行为是指化学物质的时间相关（非稳态）半无限扩散，如下图A所示，在电极/电解质界面处存在单个边界，距离
x=0。朝向本体溶液，并且在静止条件下，扩散层扩展到由电化学电池的尺寸限定的无限长度（x→∞），同时浓度梯度随时间下降。</p>
<p>将扩散层视为由无数个 “电阻（<span
class="math inline"><em>R</em><sub><em>d</em></sub></span>）-
电容（<span
class="math inline"><em>C</em><sub><em>d</em></sub></span>）”
单元串联，其中：</p>
<ul>
<li><p><span
class="math inline"><em>R</em><sub><em>d</em></sub></span>：单位长度的扩散电阻（反映扩散阻力）</p></li>
<li><p><span
class="math inline"><em>C</em><sub><em>d</em></sub></span>：单位长度的
“化学电容”（反映浓度存储能力）</p></li>
<li><p>半无限扩散——无限长传输线，阻抗为Warburg直线</p></li>
<li><p>有限扩散——有限长传输线，末端接电阻（投射）或电容（反射）</p>
<ul>
<li>当有限扩散区对扩散物质可渗透时，随着时间和电流流过电化学电池，建立了稳态浓度梯度（dC/dx=常数）。这是透射或可渗透边界的情况。</li>
<li>当有限扩散区在一段时间后对扩散物质不渗透时，电荷转移是不可能的，并且扩散物质的浓度梯度变为零（dC/dx=0）。这是反射或不渗透边界的情况</li>
</ul></li>
</ul>
<figure>
<img src="images_large_tg2c00070_0018-1756610307135-17.jpeg"
alt="A）电化学电池的半无限区，（B）半无限区的传输线（TL）描述，（C）t&lt;td 跨度处的有限边界扩散，（D）透射，和（E）t&gt;td 处的反射边界" />
<figcaption
aria-hidden="true">A）电化学电池的半无限区，（B）半无限区的传输线（TL）描述，（C）t&lt;td
跨度处的有限边界扩散，（D）透射，和（E）t&gt;td
处的反射边界</figcaption>
</figure>
<p>==具有透射边界的有限长度线性扩散的典型例子包括固体氧化物或聚合物膜燃料电池，和旋转盘电极实验中的扩散层==</p>
<h2 id="固态电解质的阻抗谱分析">固态电解质的阻抗谱分析</h2>
<p>以陶瓷固态电解质为例，<strong>假设其仅存在单离子传输而不具有电子导电性</strong></p>
<p><strong>在极高频率区域（&gt;1 MHz）的阻抗数据对于通过 EIS
测量分析固体电解质至关重要</strong>，这与其它材料的 EIS
分析存在显著差异。若某固体电解质的体相离子电导率为<span
class="math inline">10<sup>−4</sup><em>S</em> ⋅ <em>c</em><em>m</em><sup>−1</sup></span>
，且离子迁移相关电容为<span
class="math inline">10<sup>−11</sup><em>F</em> ⋅ <em>c</em><em>m</em><sup>−2</sup></span>
，则对应<span
class="math inline">1/(2<em>π</em> × <em>τ</em>)</span>（<span
class="math inline"><em>τ</em></span>：时间常数）的特征频率约为∼<span
class="math inline">10<sup>7</sup></span>Hz（10
MHz）。若未对该频率区域采取特殊防护措施进行EIS测量，高频区的阻抗数据将会缺失，仅能观测到部分圆弧。在此情况下，EIS数据中包含的来自电缆和电池的电子电阻分量无法消除。此外，由晶粒内部电阻和晶界电阻构成的离子电阻也无法分离，从而导致固体电解质重要信息的丢失。</p>
<p>由于大多数陶瓷固体电解质是由不同尺寸和取向的晶粒聚集而成的多晶材料，除了晶粒内部电阻外，离子在晶粒间界面处的传输电阻对离子电导率具有重要影响。晶粒内部电阻<span
class="math inline">$R_{\rm{gi}}$</span>
（又称体电阻）是材料固有的离子传输阻力。因此，<strong>若测试样品不含孔隙，通过晶粒内部电阻倒数计算得到的体离子电导率等于该固体电解质单晶的离子电导率</strong>。晶界电阻<span
class="math inline">$R_{\rm{gb}}$</span>
表示离子穿越晶粒间界面（晶界）及/或位于晶界的化学组成不同微相时所受的传输阻力。下图展示了陶瓷固体电解质的等效电路及Nyquist图，该电路由两个串联的并联
RC 回路构成：一个电阻对应<span class="math inline">$R_{\rm{gi}}$</span>
，另一个对应<span class="math inline">$R_{\rm{gb}}$</span>
。由于两个并联RC电路具有不同的时间常数<span
class="math inline">（<em>τ</em> = <em>R</em> × <em>C</em>）</span>，电化学阻抗谱能够分别测定这两个电阻值。</p>
<figure>
<img src="22-66080fig01-1756610307135-16.jpg"
alt="由两个并联RC电路组成的固体电解质等效电路，分别对应晶粒内部与晶界的串联连接。(b)是根据(a)所示等效电路计算得出的固体电解质典型Nyquist图。需注意，为简化起见图中省略了电极响应部分。" />
<figcaption
aria-hidden="true">由两个并联RC电路组成的固体电解质等效电路，分别对应晶粒内部与晶界的串联连接。(b)是根据(a)所示等效电路计算得出的固体电解质典型Nyquist图。需注意，为简化起见图中省略了电极响应部分。</figcaption>
</figure>
<p>由于开发和改进陶瓷固体电解质最有效的方法是通过降低<span
class="math inline">$\rm{R_{gb}}$</span>
使离子电导率接近单晶水平，因此分离<span
class="math inline">$\rm{R_{gi}}$</span> 和<span
class="math inline">$\rm{R_{gb}}$</span>
并分别评估它们至关重要。要通过高频区半圆直径确定<span
class="math inline">$\rm{R_{gi}}$</span>
，应通过增加电解质厚度、减小电极面积或降低测量温度来降低特征频率。然而这些方法存在局限性，例如当电极面积小于样品几何面积时会干扰样品中的电流分布，因此需要测量直至高频区的阻抗数据。本文介绍了我们测量固体电解质高达
100 MHz 高频阻抗的方法。</p>
<p>在固体电解质的电化学阻抗谱（EIS）测量中，通常采用电极/电解质/电极的三明治结构组件。这种配置的优势在于能够实现简单的两端测量（<strong>注：设备与电极之间需连接两根电压线和两根电流线，共计四根电缆</strong>）。采用电极/电解质/电极结构进行EIS测量时，电极材料的选择至关重要。电极材料需满足以下必要条件：能够构建稳定界面且不与电解质发生化学反应，同时具备足够的电子导电性。金或铂等贵金属常被用作阻塞电极，某些情况下也会采用能与移动离子发生可逆反应的可逆电极。圆盘状固体电解质样品通常通过粉末压片成型，必要时还需进行煅烧处理。
样品的相对密度最好大于 90%，理想情况下应超过 95%。</p>
<p>在电极涂覆工艺中，有两个关键因素会影响固体电解质的阻抗测量结果。其一是电极厚度：过薄的电极可能导致阻抗数据偏离原始值，进而造成对固体电解质离子传输行为的误判。其二是固体电解质的表面状态，该因素会显著影响阻抗测量。本节将详细阐述这两个因素如何影响阻抗数据。</p>
<p>下图展示了不同电极厚度及固体电解质表面是否抛光处理的氟离子导体Nyquist图。所有情况下均采用溅射法沉积直径为7mm
的铂电极。阻抗测试使用 Keysight E4990A
阻抗分析仪在室温空气环境下完成。所有Nyquist图均呈现两个特征：由晶粒内部与晶界电阻（具有相近时间常数）形成的畸变弧线（两个半圆弧融合），以及低频区对应阻塞电极与固体电解质界面电容特性的直线段。不同电极厚度的Nyquist图存在显著差异：对于
200 nm 厚电极（图
2a），离子传输电阻（晶粒内部与晶界电阻）形成的阻抗弧起始于坐标原点；而
50 nm 薄电极（图
2b）的阻抗弧则发生水平偏移，且由阻抗弧外推得到的高频极限阻抗值偏离原点。
这种因电极厚度不同而产生的差异可归因于样品中的电流分布；对于较薄的电极，其横向电阻不容忽视</p>
<figure>
<img src="22-66080fig02RGB-1756610307135-18.jpg"
alt="采用铂电极的氟离子传导固体电解质的Nyquist图：(a) 200 纳米厚度电极，(b) 50 纳米厚度电极。(c) 样品表面抛光后 50 纳米铂电极的Nyquist图。右侧为放大视图以便观察。圆圈表示测量值，虚线表示拟合曲线。" />
<figcaption
aria-hidden="true">采用铂电极的氟离子传导固体电解质的Nyquist图：(a) 200
纳米厚度电极，(b) 50 纳米厚度电极。(c) 样品表面抛光后 50
纳米铂电极的Nyquist图。右侧为放大视图以便观察。圆圈表示测量值，虚线表示拟合曲线。</figcaption>
</figure>
<p>如上图，当样品<strong>经 2000 目砂纸抛光并</strong>沉积 50
纳米铂电极后，所得阻抗弧严重偏离原点。这表明抛光过程引入了除离子传输过程之外的额外电阻。此外，抛光样品的离子传导过程对应阻抗弧略有扩大，直线斜率趋于平缓。这种斜率变化反映了抛光前后样品阻塞行为的差异：抛光样品在&lt;1
MHz
频率区间出现与阻塞行为重叠的寄生电阻。<strong>固态电解质抛光前后的阻抗行为变化归因于抛光过程中（为去除煅烧样品表面偏析层而进行的）样品表面劣化</strong>。</p>
<p>为消除电缆电感对高频测量的干扰，设备与电解池（样品）之间的连接电缆应尽可能缩短。建议采用特性阻抗为
50Ω的同轴电缆，并将其紧贴样品安装。此外，必须合理设置电流回流路径。对于高达
100MHz
的高频测量，需确保电缆不会引起相位差畸变。在进行高频测量前，应对系统进行开路/短路/负载校准</p>
<h2 id="离子电导率的计算">离子电导率的计算</h2>
<p><span class="math display">$$
\sigma'(\omega)=\dfrac{L}{S}\times\dfrac{Z'(\omega)}{\vert Z'(\omega)
\rvert ^2}
$$</span></p>
<p>对于使用固态电解质模具进行电化学阻抗谱测试的情况，离子电导率的计算公式为：
<span class="math display">$$
\sigma =\dfrac{L}{S\times R}
$$</span> 其中<span
class="math inline"><em>L</em></span>为固态电解质pellet圆片厚度，<span
class="math inline"><em>S</em></span>为圆片pellet的面积，<span
class="math inline"><em>R</em></span>为电阻（Nyquist图拐点处的横坐标）</p>
<h2
id="实战演练以rmli_5.5ps_4.5cl_1.5的电化学阻抗谱图为例">实战演练——以<span
class="math inline">$\rm{Li_{5.5}PS_{4.5}Cl_{1.5}}$</span>的电化学阻抗谱图为例</h2>
<figure>
<img src="TEST-1756610307135-19.png" alt="之前测的阻抗偶" />
<figcaption aria-hidden="true">之前测的阻抗偶</figcaption>
</figure>
<p>这是之前测试的图，简单画了一下，2Tons（249MPa）压力下的测试结果。可以看到，这与常见的阻抗谱差别非常大，并没有出现超高频的半圆弧，只出现了低频的扩散部分和中高频的拐点。这是收阻抗仪的最高频率所限，使用的阻抗仪最高频只能达到约1MHz左右，对于10mS/cm的固态电解质，想要完整的测出半圆弧可能需要100MHz甚至更高的频率</p>
<figure>
<img src="image-20250612163437996-1756610307135-21.png"
alt="image-20250612163437996" />
<figcaption aria-hidden="true">image-20250612163437996</figcaption>
</figure>
<ul>
<li>由于设备频率上限较低，只能得到粒子抵抗和粒界阻抗的总值</li>
<li>活化能分析中无法判断随温度变化特性值发生变化的是粒子阻抗还是粒界阻抗</li>
<li>在通过变温方式尝试分离粒子阻抗和粒界阻抗时，可控温度范围有限，且无法对变温引起的参数条件变化进行校正</li>
</ul>
<p>==此外，交变电流源的最高频率不等于最高有效频率==，有效的最高频率常常受限于测试端子类型和连线长度，在进行变温控制的时候，==夹具及导线材料的介电常数因为温度变化而变化，如果不及时矫正阻抗会使结果产生较大偏离==</p>
<figure>
<img src="image-20250612164042178-1756610307135-20.png"
alt="image-20250612164042178" />
<figcaption aria-hidden="true">image-20250612164042178</figcaption>
</figure>
<p>下图展示了超高有效频率下的LLTO型固态电解质的阻抗谱</p>
<figure>
<img src="image-20250612164142858-1756610307135-22.png"
alt="image-20250612164142858" />
<figcaption aria-hidden="true">image-20250612164142858</figcaption>
</figure>
<h2 id="参考资料">参考资料</h2>
<ol type="1">
<li>Lazanas, A. Ch.; Prodromidis, M. I. Electrochemical Impedance
Spectroscopy─a Tutorial. ACS Meas. Sci. Au 2023, 3 (3), 162–193.
https://doi.org/10.1021/acsmeasuresciau.2c00070.</li>
<li>Lazanas, A. Ch.; Prodromidis, M. I. Correction to “Electrochemical
Impedance Spectroscopy─a Tutorial.” ACS Meas. Sci. Au 2025, 5 (1),
156–156. https://doi.org/10.1021/acsmeasuresciau.5c00007.</li>
<li>Ariyoshi, K.; Mineshige, A.; Takeno, M.; Fukutsuka, T.; Abe, T.;
Uchida, S.; Siroma, Z. Electrochemical Impedance Spectroscopy Part 2:
Applications. Electrochemistry 2022, 90 (10), 102008–102008.
https://doi.org/10.5796/electrochemistry.22-66080.</li>
<li>Ariyoshi, K.; Siroma, Z.; Mineshige, A.; Takeno, M.; Fukutsuka, T.;
Abe, T.; Uchida, S. Electrochemical Impedance Spectroscopy Part 1:
Fundamentals. Electrochemistry 2022, 90 (10), 102007–102007.
https://doi.org/10.5796/electrochemistry.22-66071.</li>
<li>Hu, W.; Peng, Y.; Wei, Y.; Yang, Y. Application of Electrochemical
Impedance Spectroscopy to Degradation and Aging Research of Lithium-Ion
Batteries. J. Phys. Chem. C 2023, 127 (9), 4465–4495.
https://doi.org/10.1021/acs.jpcc.3c00033.</li>
</ol>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/27/%E7%A7%91%E7%A0%94/first%20stage/%E7%94%B5%E5%8C%96%E5%AD%A6%E9%98%BB%E6%8A%97%E8%B0%B1/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/25/%E7%A7%91%E7%A0%94/first%20stage/%E7%A7%91%E7%A0%94%E4%B8%AD%E7%9A%84%E9%97%AE%E9%A2%98/"
                            aria-label=": 科研中的小问题"
                        >
                            科研中的小问题
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-25T16:40:40+08:00">
	
		    May 25, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/first-stage/">first stage</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1 id="实验部分">实验部分</h1>
<h2 id="球磨">球磨</h2>
<ul>
<li>球磨的原理是什么？</li>
<li>球磨的作用是什么？</li>
<li>200rpm合不出来，300rpm就能合出来？</li>
</ul>
<h2 id="x-ray-diffraction">X-ray diffraction</h2>
<ul>
<li>X射线是什么？</li>
<li>X射线衍射的原理和用途是什么？</li>
<li>XRD谱图的横坐标和纵坐标分别是什么意义？</li>
<li>XRD为什么会产生峰？峰是什么意义？</li>
<li>横坐标2theta角度为什么通常选择20<span
class="math inline"><sup>∘</sup></span>~80<span
class="math inline"><sup>∘</sup></span></li>
<li>单晶衍射和粉末衍射分别是什么？</li>
<li>关于消光？</li>
</ul>
<p>近年来锂离子电池大规模应用的快速发展要求系统地了解锂离子电池的退化机制，这在很大程度上取决于先进表征方法的利用和发展。基于
X 射线的技术，如 X 射线吸收光谱（XAS）、X 射线衍射（XRD）和 X
射线光电子能谱（XPS），可以确定化学成分和元素的价态和晶体结构的变化。
电子和扫描探针显微技术，（3）如扫描电子显微镜（SEM）、透射电子显微镜（TEM）和低温透射电镜，可以观察电极的形貌变化和固体电解质界面（SEI）的厚度。基于滴定的技术，如滴定气相色谱（TGC）（4）和质谱滴定（MST），（5,6）可以定量死
Li 金属和 SEI
组分。此外，固态核磁共振（NMR）（7）和电子顺磁共振（EPR）（8）能够实现对
Li
镀层的时间分辨和定量检测。然而，这些方法大多是侵入性技术，需要额外昂贵以及具有特殊电池设计的精密仪器进行测试，在实际应用中是不可行的。
除了这些物理特性之外，电化学方法，如差分电压分析（DVA）、（9,10）差分充电电压（DCV）、（11）增量容量分析（ICA）、（12）和库仑效率（CE）、（13,14）也在电池老化研究中发挥了重要作用。然而，它们是相当复杂的确定方法，需要很长的监测时间。</p>
<h2 id="电化学阻抗谱测试">电化学阻抗谱测试</h2>
<ul>
<li>为什么测出来的Nyquist图没有半圆部分呢？</li>
</ul>
<h2 id="理论知识">理论知识</h2>
<p>记得看Sob老师的博客，多逛逛计算化学公社呀</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/25/%E7%A7%91%E7%A0%94/first%20stage/%E7%A7%91%E7%A0%94%E4%B8%AD%E7%9A%84%E9%97%AE%E9%A2%98/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/24/%E7%A7%91%E7%A0%94/first%20stage/2025-05-24-%E5%85%B3%E4%BA%8EX%E5%B0%84%E7%BA%BF%E7%B2%89%E6%9C%AB%E8%A1%8D%E5%B0%84/"
                            aria-label=": 从零开始的X射线原理"
                        >
                            从零开始的X射线原理
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-24T20:24:00+08:00">
	
		    May 24, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/first-stage/">first stage</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="前言">前言</h2>
<p>1917 年，赫尔首次描述了简单粉末衍射仪的构造，这是在 1895
年威廉·康拉德·伦琴发现 X 射线后不久。衍射仪测量 X
射线反射的角度，从而获得其包含的结构信息。如今，这项技术的分辨率有了显著提高，它被广泛用作分析相信息和解决固态材料晶体结构的工具。X
射线衍射技术用于确定<strong>样品的组成</strong>或<strong>晶体结构</strong>。对于大分子和无机化合物等<strong>较大的晶体</strong>，它可用于确定样品中原子的结构。如果<strong>晶体尺寸太小</strong>，它可以确定样品的组成、结晶度和相纯度。</p>
<h2 id="什么是x射线">什么是X射线？</h2>
<p>X射线是一种<strong>电磁波</strong>，由内壳层电子跃迁所得：</p>
<figure>
<img
src="Screen%20Shot%202022-08-29%20at%2010.39.21%20PM-1756610339401-1.png"
alt="X 射线由内壳层电子跃迁产生" />
<figcaption aria-hidden="true">X 射线由内壳层电子跃迁产生</figcaption>
</figure>
<p>对于原子序数为Z、仅含一个电子的类氢原子，内壳层电子跃迁所辐射的能量可由Rydberg方程计算：
<span class="math display">$$
\bar{v}=(\dfrac{1}{n_i^2}-\dfrac{1}{n_f^2})RZ^2
$$</span>
可以明显看出，与电子跃迁相关的能量差随着原子序数的增加而大幅增大，并且在这种跃迁过程中发射的辐射波长随着原子序数的增加从
10<span class="math inline"><sup>−7</sup></span> m (1000 Å) 范围移至
10<span class="math inline"><sup>−10</sup></span> m (1
Å)范围（<strong>此时辐射的电磁波被定义为X射线，此辐射类型被称为特征辐射</strong>）、</p>
<p>如下图，要引发这种内壳层跃迁，需要产生一个电子空位，必须从K层中移除一个电子。由高压电场加速过的阴极电子书轰击靶材，将其部分能量传递给靶材料的电子，从而导致电子激发。如果入射电子的能量足够高，一些电子可能会击出靶中
K 壳层的一个电子，从而产生一个空位</p>
<figure>
<img
src="Screen%20Shot%202022-08-29%20at%2010.47.31%20PM-1756610339401-2.png"
alt="X射线的产生" />
<figcaption aria-hidden="true">X射线的产生</figcaption>
</figure>
<p>不同能级跃迁回K层对应着不同的谱线，如<span
class="math inline">$\rm{K_{\alpha}}$</span>线和<span
class="math inline">$\rm{K_{\beta}}$</span>线。对于铜的X射线光谱，在低能分辨率下只有2条特征线被观察到，但是，在更高的分辨率下，很容易看出Kα线是双峰，它被标记为<span
class="math inline">$\rm{K_{α1}}$</span>和<span
class="math inline">$\rm{K_{α2}}$</span>。因为铜的2p轨道，能级L分裂为<span
class="math inline">$\rm{L_{II}}$</span>和<span
class="math inline">$\rm{L_{III}}$</span>，间距非常小（0.020kev），波长Kα1
(= 1.54056 Å) 和Kα2 (= 1.54439 Å) 也非常接近。因此，通常说的<span
class="math inline">$\rm{K_{\alpha}}$</span>其实是<span
class="math inline">$\rm{K_{α1}}$</span>和<span
class="math inline">$\rm{K_{α2}}$</span>的加权平均值</p>
<figure>
<img src="v2-83f3a61a473493f00779f96bc4c4f9b0_720w-1756610339401-3.webp"
alt="Cu的原子能级" />
<figcaption aria-hidden="true">Cu的原子能级</figcaption>
</figure>
<table>
<thead>
<tr>
<th>阳极</th>
<th><span class="math inline">$\rm{K_{\alpha}}$</span></th>
<th><span class="math inline">$\rm{K_{\beta}}$</span></th>
</tr>
</thead>
<tbody>
<tr>
<td>铜</td>
<td>1.54184Å</td>
<td>1.39222Å</td>
</tr>
<tr>
<td>钼</td>
<td>0.71073Å</td>
<td>0.63229Å</td>
</tr>
</tbody>
</table>
<p>以铜靶为例 <span class="math display">$$
E=\dfrac{hc}{\lambda}=\dfrac{6.626\times10^{-34}\times2.998\times
10^8}{1.542\times 10^{-10}\times1.6\times10^{-19}}=8.05~\rm{kV}
$$</span> 8.05 kV为铜的<span class="math inline">$\rm{K_{\alpha
1}}$</span>线的最低激发电压，实际操作时通常选择40kV。激发电压选择过低会造成谱线不明显、电流过大热损耗大等问题，选择40kV是长期实验优化的结果。</p>
<p>由于种种原因，如量子力学的选择定则：电子跃迁需要满足角动量变化Δl=±1、散热和成本等问题，通常X射线光谱中不会出现<span
class="math inline">$\rm{K_{\gamma}}$</span>甚至更高的线，即使能够发生N→K的跃迁（比如高Z元素W)，也会因为强度极弱而湮灭在噪声中，因此X射线光谱中通常见到的是<span
class="math inline">$\rm{K_{\alpha}}$</span>和<span
class="math inline">$\rm{K_{\beta}}$</span></p>
<figure>
<img
src="Screen%20Shot%202022-08-29%20at%2010.50.56%20PM-1756610339401-4.png"
alt="产生特征X射线的电子跃迁示意图（钼靶）" />
<figcaption
aria-hidden="true">产生特征X射线的电子跃迁示意图（钼靶）</figcaption>
</figure>
<p>此外，在高速电子轰击靶材的过程中除了由内壳层电子跃迁所辐射的特征X射线，还存在着<strong>轫致辐射</strong>：高速电子被靶材原子核电场偏转，动能转化为连续电磁辐射。</p>
<p>如下图，当加速电压（单位：kV）较小、高速电子无法引起内壳层跃迁时（<strong>加速电压小于临界电压</strong>），那么此时原子的辐射均为<strong>轫致辐射</strong></p>
<p><img
src="Screen%20Shot%202022-08-29%20at%2010.59.00%20PM-1756610339401-5.png"
alt="钼靶 X 射线光谱随施加电压的变化关系" /> <span
class="math display">$$
V_{临界}=\dfrac{hc}{e\lambda_{K-edge}}
$$</span></p>
<p>在所得的一系列X射线中，只有满足布拉格条件（波长与晶面间距d匹配）的射线才可用于样品检测，因此需要通过滤光片等手段只保留窄带波长，去除了除
K<span class="math inline"><sub><em>α</em></sub></span> X
射线之外的所有电磁波</p>
<h2 id="xrd谱图上的峰是什么">XRD谱图上的峰是什么？</h2>
<p>XRD——X-ray diffraction（X射线衍射），其本质是波的干涉与叠加。</p>
<p>当波（如光波、声波、X射线）遇到障碍物或穿过周期性结构时，波前会发生弯曲和重新分布，这种现象称为衍射。障碍物或结构的尺寸与波长相当，这是发生衍射的关键条件，正因如此，与原子间距匹配的X射线适合用作发生衍射的电磁波。X射线是电磁波，照射到晶体时，<strong>每个原子中的电子受X射线的作用，成为次级波源</strong>，向四周散射X射线（这种散射也被称为相干散射），这些不同路径的X射线相遇并发生干涉（衍射发生的本质是<strong>弹性散射波</strong>，（即此时的次级X射线）的干涉）</p>
<p>干涉分为两类：</p>
<ul>
<li><strong>相长干涉（Constructive
Interference）</strong>：满足布拉格条件时，所有晶面的散射波<strong>相位一致</strong>，两列波<strong>波峰对齐</strong>，叠加后振幅增强
→ 形成<strong>峰</strong>。</li>
<li><strong>相消干涉（Destructive
Interference）</strong>：波峰与波谷对齐，叠加后振幅抵消 →
形成暗区。</li>
</ul>
<p>布拉格定律： <span
class="math display"><em>n</em><em>λ</em> = 2<em>d</em>sin <em>θ</em></span>
其中λ是外加波长，θ是衍射角，d
是原子平面之间的距离。在大多数情况下，我们假定n=1，即一级衍射，因为总可以将
n=2,3,…的衍射峰解释为来自(nh nk nl) 晶面的衍射——即来自晶面间距为<span
class="math inline">$\rm{d_{hkl}}$</span>的<span
class="math inline">$\dfrac{1}{n}$</span>倍的晶面<span
class="math inline">$\rm{d_{nhnknl}}$</span>。然后，原子平面之间的距离可用于确定成分或晶体结构。</p>
<figure>
<img src="braggslaw-1756610339401-6.jpg" alt="braggs law" />
<figcaption aria-hidden="true">braggs law</figcaption>
</figure>
<p>当路径 ABC 与 A’B’C’之间的距离相差整数个波长（λ）时，衍射的 X
射线表现出相长干涉</p>
<p>X 射线衍射的结果绘制出了在各自的
2θ位置处不同衍射角的信号强度。2θ位置对应于<strong>样品中晶体或原子之间的特定间距</strong>，该间距由入射到样品中的
X
射线束的衍射角决定。<strong>峰的强度</strong>与<strong>该相或具有该间距的分子数量</strong>有关。峰的强度越大，具有该特定间距的晶体或分子数量就越多。</p>
<h2
id="消光是什么为什么只有特定的晶面处才会出现峰">消光是什么？为什么只有特定的晶面处才会出现峰？</h2>
<p>衍射峰强度取决于晶胞内所有原子散射辐射之间的相位关系，但经常出现这种情况：虽然布拉格定律预测某个峰应该存在，但其实际强度却为零（这是因为布拉格定律不涉及原子位置，仅与晶胞的大小和形状有关）。</p>
<p>例如，对于具有体心立方BCC晶胞的(100)晶面衍射峰强度：相位关系表明，在晶胞顶面和底面（即(100)晶面）散射的
X 射线虽然发生相长干涉，但与晶胞中心原子散射的X射线存在180<span
class="math inline"><sup>∘</sup></span>的相位差，因此最终强度为零。下表给出了不同立方晶格中特定衍射峰出现与否的选择定则。</p>
<table style="width:100%;">
<colgroup>
<col style="width: 24%" />
<col style="width: 53%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr>
<th>Bravais Lattice</th>
<th>Reflections Present</th>
<th>Reflections Absent</th>
</tr>
</thead>
<tbody>
<tr>
<td>Simple Cubic</td>
<td>All</td>
<td>None</td>
</tr>
<tr>
<td>Body-Centered Cubic</td>
<td>(h+k+l)= even</td>
<td>(h+k+l)= odd</td>
</tr>
<tr>
<td>Face-Centered Cubic</td>
<td>h,k,l unmixed (either all odd or all even)</td>
<td>h,k,l mixed</td>
</tr>
<tr>
<td>Base-Centered Cubic</td>
<td>h,k unmixed (either all even or all odd)</td>
<td>h,k mixed</td>
</tr>
</tbody>
</table>
<h2
id="为什么谱图的横坐标是2θ"><strong>为什么谱图的横坐标是2θ</strong>？</h2>
<p>实验中，样品和探测器的转动是围绕同一轴进行的，因此
<strong>总偏转角的计算需要结合样品和探测器的相对运动</strong>，如下图所示</p>
<figure>
<img src="IMG_20250524_210927-1756610339401-7.jpg" alt="示意图" />
<figcaption aria-hidden="true">示意图</figcaption>
</figure>
<h2 id="峰宽度的意义是什么">峰宽度的意义是什么？</h2>
<p><strong>峰的宽度与晶体尺寸成反比</strong>。较窄的峰对应较大的晶体。较宽的峰意味着可能存在较小的晶体、晶体结构缺陷，或者样品在本质上可能是非晶态的，即一种缺乏完美结晶度的固体。对于较小的样品，将由X
射线衍射（XRD）所得的图谱与数据库中标准样品的谱图对比可确定样品的组成。此结论可由<strong>谢乐公式（Debye-Scherrer）</strong>直接给出
<span class="math display">$$
D=\dfrac{K\lambda}{B \cos\theta}
$$</span></p>
<ul>
<li><p>K为Scherrer常数，也称形状因子，若B为衍射峰的半峰高宽，则K=0.89；</p></li>
<li><p>D为晶粒垂直于晶面方向的平均厚度（Å）；</p></li>
<li><p>B为实测样品衍射峰半高宽度</p></li>
<li><p>θ为布拉格衍射角，单位为角度</p></li>
<li><p>λ为X射线]波长，对于Cu kα来说，一般为1.54056 Å</p></li>
</ul>
<h2
id="为什么晶相能相长干涉形成峰而非晶相不能"><strong>为什么晶相能相长干涉形成峰，而非晶相不能？</strong></h2>
<p>晶体是长程有序的<strong>周期性结构</strong>，满足布拉格条件，即所有晶面(hkl)的的间距d恒定，当入射角θ满足布拉格公式时，所有晶面的散射波相位一致
→ 相长干涉 → 尖锐峰。</p>
<p>非晶体可能短程有序，而长程无序，d值不固定，
散射波来自不同局部区域，相位杂乱，无法形成尖锐的峰</p>
<h3 id="举个例子">举个例子</h3>
<p>例子仅供参考</p>
<p>晶体硅的晶胞参数a=0.543nm，X射线波长为0.154nm，那么我们可以预测某个晶面会在何处出现峰</p>
<p>对于立方晶系： <span class="math display">$$
d_{hkl}=\dfrac{a}{\sqrt{h^2+k^2+l^2}}
$$</span> 以(111)晶面为例 <span class="math display">$$
d_{111}=\dfrac{0.543}{\sqrt{3}}=0.314nm
$$</span> 根据布拉格公式： <span class="math display">$$
\theta =\arcsin (\dfrac{\lambda}{2d_{111}})=14.3^\circ
$$</span></p>
<h2 id="如何确定2theta角度">如何确定2theta角度？</h2>
<p>虽然理论上2θ范围是0°~180°，但实际操作中极少覆盖全部范围，原因包括：</p>
<ul>
<li><strong>物理限制</strong>：大多数晶面间距d有一个最小值，那么<span
class="math inline">$\theta_{\rm{max}} \le
\arcsin(\dfrac{\lambda}{2d_{\rm{min}}})$</span></li>
<li><strong>信号强度</strong>：高角度区（如2θ&gt;120°）的衍射强度极弱，信噪比差。</li>
<li><strong>时间成本</strong>：全范围扫描耗时过长，而关键峰通常集中在<strong>20°~80°</strong></li>
</ul>
<p>一般选择20~80°，一般情况</p>
<p><strong>常规晶体材料</strong>的晶面间距d大多在<strong>1~10Å</strong>之间</p>
<ul>
<li><strong>Cu靶X射线波长λ≈1.54Å</strong>，代入公式：
<ul>
<li>当d=10Å时，( <span class="math inline">$\sinθ = λ/(2d)
≈0.077$</span> → θ≈4.4° → 2θ≈8.8°)</li>
<li>当d=1Å时，( <span class="math inline">$\sinθ = 0.77$</span> → θ≈50°
→ 2θ≈100°)</li>
</ul></li>
</ul>
<h2 id="参考资料">参考资料</h2>
<ol type="1">
<li>Sadoway, D. Introduction to Solid State Chemistry.</li>
<li>Reig, A. CHEM322: Inorganic Chemistry.</li>
</ol>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/24/%E7%A7%91%E7%A0%94/first%20stage/2025-05-24-%E5%85%B3%E4%BA%8EX%E5%B0%84%E7%BA%BF%E7%B2%89%E6%9C%AB%E8%A1%8D%E5%B0%84/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/18/%E7%A7%91%E7%A0%94/VASP/Starry%20Sky/%E4%BD%BF%E7%94%A8Multiwfn%E5%8A%A0%E8%BD%BDELFCAR%E7%BB%98%E5%88%B6%E7%AD%89%E5%80%BC%E9%9D%A2%E5%9B%BE/"
                            aria-label=": 使用Multiwfn加载ELFCAR文件绘制等值面图"
                        >
                            使用Multiwfn加载ELFCAR文件绘制等值面图
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-18T08:40:00+08:00">
	
		    May 18, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/VASP/">VASP</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><strong>本文仅为学习记录，并非教程</strong></p>
<p><code>Multiwfn</code>是一个波函数分析程序，功能非常强大，也能绘制ELF等值面图，它支持多种类型的输入文件，既有量子化学计算程序的输出文件，又有第一性原理计算程序的输出文件</p>
<figure>
<img src="1%20(1)-1756610428425-1.png"
alt="Multiwfn的输入文件(http://sobereva.com/379)" />
<figcaption
aria-hidden="true">Multiwfn的输入文件(http://sobereva.com/379)</figcaption>
</figure>
<p>以下是<code>Multiwfn</code>加载<code>ELFCAR</code>绘制等值面图的过程</p>
<ul>
<li>step1：<a
target="_blank" rel="noopener" href="http://sobereva.com/452">用<code>ELFCAR</code>绘图其实是基于格点数据文件的绘图，需要修改根目录下的配置文件<code>settings.ini</code>，将参数<code>iuserfunc</code>改为-1或者-3</a></li>
<li>step2：加载<code>ELFCAR</code>文件</li>
<li>step3：4 Output and plot specific property in a plane</li>
<li>step4：100 User-defined function (iuserfunc=</li>
<li>step5：5 Shaded relief map with projection</li>
<li>step6：1: XY plane</li>
<li>step7：1a</li>
</ul>
<p>如果将<code>Multiwfn</code>的根目录添加到<code>PATH</code>环境变量以方便调用，那么画出来的图可能会遇到如下如题</p>
<figure>
<img src="QQ20250515-193116-1756610428425-3.png"
alt="在非根目录下调用Multiwfn" />
<figcaption aria-hidden="true">在非根目录下调用Multiwfn</figcaption>
</figure>
<p>如果直接在根目录下双击<code>.exe</code>文件运行的话就能正常绘图</p>
<figure>
<img src="QQ20250518-092244-1756610428425-2.png"
alt="正常的ELF等值面图" />
<figcaption aria-hidden="true">正常的ELF等值面图</figcaption>
</figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/18/%E7%A7%91%E7%A0%94/VASP/Starry%20Sky/%E4%BD%BF%E7%94%A8Multiwfn%E5%8A%A0%E8%BD%BDELFCAR%E7%BB%98%E5%88%B6%E7%AD%89%E5%80%BC%E9%9D%A2%E5%9B%BE/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/17/%E7%A7%91%E7%A0%94/first%20stage/%E6%8E%BA%E6%9D%82%E8%B4%A8%E9%87%8F%E8%AE%A1%E7%AE%97/"
                            aria-label=": 掺杂质量计算的python脚本"
                        >
                            掺杂质量计算的python脚本
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-17T20:40:00+08:00">
	
		    May 17, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/VASP/">VASP</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>起因是我想合成各式各样的材料，需要用到各种药品，计算起来比较麻烦，尤其是非化学计量比的化合物比如<span
class="math inline">Li<sub>5.3</sub>PS<sub>4.3</sub>Cl<sub>0.7</sub>Br</span>，遂用AI写了一个<code>python</code>脚本，个人觉得还是比较实用，脚本文件和相对原子质量的文本文件需要在同一文件夹内</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> decimal <span class="keyword">import</span> Decimal, getcontext</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Matrix, linsolve, Rational</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="comment"># Improve Decimal precision</span></span><br><span class="line">getcontext().prec = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FormulaParser</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">formula: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        elements = &#123;&#125;</span><br><span class="line">        pattern = re.<span class="built_in">compile</span>(<span class="string">r&quot;([A-Z][a-z]?)([\d.]*)?&quot;</span>)</span><br><span class="line">        idx = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(formula):</span><br><span class="line">            m = pattern.<span class="keyword">match</span>(formula, idx)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> m:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Invalid formula at: <span class="subst">&#123;formula[idx:]&#125;</span>&quot;</span>)</span><br><span class="line">            elem, num = m.group(<span class="number">1</span>), m.group(<span class="number">2</span>)</span><br><span class="line">            coeff = Decimal(num) <span class="keyword">if</span> num <span class="keyword">else</span> Decimal(<span class="number">1</span>)</span><br><span class="line">            elements[elem] = elements.get(elem, Decimal(<span class="number">0</span>)) + coeff</span><br><span class="line">            idx = m.end()</span><br><span class="line">        <span class="keyword">return</span> elements</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AtomicMassReader</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">filename=<span class="string">&quot;atomic_masses.txt&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        masses = &#123;&#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                    line = line.strip()</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> line <span class="keyword">or</span> line.startswith(<span class="string">&#x27;#&#x27;</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    parts = line.split()</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(parts) != <span class="number">2</span>:</span><br><span class="line">                        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Line format error: <span class="subst">&#123;line&#125;</span>&quot;</span>)</span><br><span class="line">                    masses[parts[<span class="number">0</span>]] = Decimal(parts[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">raise</span> FileNotFoundError(<span class="string">f&quot;File <span class="subst">&#123;filename&#125;</span> not found&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> masses:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Atomic masses file empty&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> masses</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SynthesisCalculator</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, atomic_masses: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.atomic_masses = atomic_masses</span><br><span class="line">        <span class="variable language_">self</span>.target = &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.target_mm = Decimal(<span class="number">0</span>)</span><br><span class="line">        <span class="variable language_">self</span>.reagents = []</span><br><span class="line">        <span class="variable language_">self</span>.reagent_formulas = []</span><br><span class="line">        <span class="variable language_">self</span>.molar_masses = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">input_target</span>(<span class="params">self</span>):</span><br><span class="line">        f = <span class="built_in">input</span>(<span class="string">&quot;Enter target formula: &quot;</span>).strip()</span><br><span class="line">        <span class="variable language_">self</span>.target = FormulaParser.parse(f)</span><br><span class="line">        <span class="keyword">for</span> e, c <span class="keyword">in</span> <span class="variable language_">self</span>.target.items():</span><br><span class="line">            <span class="keyword">if</span> e <span class="keyword">not</span> <span class="keyword">in</span> <span class="variable language_">self</span>.atomic_masses:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Mass of element <span class="subst">&#123;e&#125;</span> not defined&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.target_mm += c * <span class="variable language_">self</span>.atomic_masses[e]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Parsed: <span class="subst">&#123;self.target&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Target molar mass = <span class="subst">&#123;self.target_mm.normalize()&#125;</span> g/mol&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">input_reagents</span>(<span class="params">self</span>):</span><br><span class="line">        n = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Enter number of reagents: &quot;</span>))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            f = <span class="built_in">input</span>(<span class="string">f&quot;Reagent <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> formula: &quot;</span>).strip()</span><br><span class="line">            <span class="variable language_">self</span>.reagent_formulas.append(f)</span><br><span class="line">            parsed = FormulaParser.parse(f)</span><br><span class="line">            mm = <span class="built_in">sum</span>(parsed[e] * <span class="variable language_">self</span>.atomic_masses[e] <span class="keyword">for</span> e <span class="keyword">in</span> parsed)</span><br><span class="line">            <span class="variable language_">self</span>.reagents.append(parsed)</span><br><span class="line">            <span class="variable language_">self</span>.molar_masses.append(mm)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;f&#125;</span> molar mass = <span class="subst">&#123;mm.normalize()&#125;</span> g/mol&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">validate</span>(<span class="params">self</span>):</span><br><span class="line">        tgt = <span class="built_in">set</span>(<span class="variable language_">self</span>.target)</span><br><span class="line">        prov = <span class="built_in">set</span>().union(*(r.keys() <span class="keyword">for</span> r <span class="keyword">in</span> <span class="variable language_">self</span>.reagents))</span><br><span class="line">        miss = tgt - prov</span><br><span class="line">        extra = prov - tgt</span><br><span class="line">        <span class="keyword">if</span> miss:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error: Missing elements: <span class="subst">&#123;miss&#125;</span>&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">if</span> extra:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Warning: Extra elements: <span class="subst">&#123;extra&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">solve_basis</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Construct A, b corresponding to 1 mol </span></span><br><span class="line">        elems = <span class="built_in">sorted</span>(<span class="built_in">set</span>(<span class="variable language_">self</span>.target) | <span class="built_in">set</span>().union(*(r.keys() <span class="keyword">for</span> r <span class="keyword">in</span> <span class="variable language_">self</span>.reagents)))</span><br><span class="line">        A = [[r.get(e, Decimal(<span class="number">0</span>)) <span class="keyword">for</span> r <span class="keyword">in</span> <span class="variable language_">self</span>.reagents] <span class="keyword">for</span> e <span class="keyword">in</span> elems]</span><br><span class="line">        b = [<span class="variable language_">self</span>.target.get(e, Decimal(<span class="number">0</span>)) <span class="keyword">for</span> e <span class="keyword">in</span> elems]</span><br><span class="line">        <span class="comment"># Convert to rational number to avoid floating point error</span></span><br><span class="line">        A_rat = [[Rational(<span class="built_in">str</span>(val)) <span class="keyword">for</span> val <span class="keyword">in</span> row] <span class="keyword">for</span> row <span class="keyword">in</span> A]</span><br><span class="line">        b_rat = [Rational(<span class="built_in">str</span>(val)) <span class="keyword">for</span> val <span class="keyword">in</span> b]</span><br><span class="line">        <span class="built_in">vars</span> = symbols(<span class="string">f&#x27;x0:<span class="subst">&#123;<span class="built_in">len</span>(self.reagents)&#125;</span>&#x27;</span>)</span><br><span class="line">        sol = linsolve((Matrix(A_rat), Matrix(b_rat)), <span class="built_in">vars</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> sol:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Error: No exact solution for 1 mol target.&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        tup = <span class="built_in">next</span>(<span class="built_in">iter</span>(sol))</span><br><span class="line">        <span class="comment"># Convert rational to decimal exact representation</span></span><br><span class="line">        base = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i, r <span class="keyword">in</span> <span class="built_in">enumerate</span>(tup):</span><br><span class="line">            base[<span class="built_in">vars</span>[i]] = Decimal(r.p) / Decimal(r.q)</span><br><span class="line">        <span class="keyword">return</span> base, elems</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">calculate</span>(<span class="params">self</span>):</span><br><span class="line">        t = <span class="built_in">input</span>(<span class="string">&quot;Input type (0 mass g, 1 moles): &quot;</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> t <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Invalid type&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        v = Decimal(<span class="built_in">input</span>(<span class="string">&quot;Amount: &quot;</span>).strip())</span><br><span class="line">        n = v / <span class="variable language_">self</span>.target_mm <span class="keyword">if</span> t==<span class="string">&#x27;0&#x27;</span> <span class="keyword">else</span> v</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Target moles = <span class="subst">&#123;n.normalize()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        base, elems = <span class="variable language_">self</span>.solve_basis()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nReagent requirements:\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">40</span>)</span><br><span class="line">        total_mass = Decimal(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i, var <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">sorted</span>(base.keys(), key=<span class="keyword">lambda</span> x: <span class="built_in">int</span>(<span class="built_in">str</span>(x)[<span class="number">1</span>:]))):</span><br><span class="line">            moles = base[var] * n</span><br><span class="line">            mass = moles * <span class="variable language_">self</span>.molar_masses[i]</span><br><span class="line">            total_mass += mass</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Reagent <span class="subst">&#123;i+<span class="number">1</span>&#125;</span> (<span class="subst">&#123;self.reagent_formulas[i]&#125;</span>):&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  Moles: <span class="subst">&#123;moles.normalize():<span class="number">.10</span>f&#125;</span> mol&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  Mass:  <span class="subst">&#123;mass.normalize():<span class="number">.10</span>f&#125;</span> g\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Total mass = <span class="subst">&#123;total_mass.normalize():<span class="number">.10</span>f&#125;</span> g&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#Verify element balance</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Verification:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> e <span class="keyword">in</span> elems:</span><br><span class="line">            actual = <span class="built_in">sum</span>((base[symbols(<span class="string">f&#x27;x<span class="subst">&#123;i&#125;</span>&#x27;</span>)] * n) * r.get(e, Decimal(<span class="number">0</span>))</span><br><span class="line">                         <span class="keyword">for</span> i, r <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="variable language_">self</span>.reagents))</span><br><span class="line">            target_amt = <span class="variable language_">self</span>.target.get(e, Decimal(<span class="number">0</span>)) * n</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e&#125;</span>: target <span class="subst">&#123;target_amt.normalize():<span class="number">.10</span>f&#125;</span>, actual <span class="subst">&#123;actual.normalize():<span class="number">.10</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;High-Precision Compound Synthesis Calculator&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        masses = AtomicMassReader.read()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Loaded elements: <span class="subst">&#123;<span class="string">&#x27;, &#x27;</span>.join(masses.keys())&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        exit()</span><br><span class="line">    calc = SynthesisCalculator(masses)</span><br><span class="line">    calc.input_target()</span><br><span class="line">    calc.input_reagents()</span><br><span class="line">    calc.validate()</span><br><span class="line">    calc.calculate()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>附一张使用截图，后面也会放到<code>Github</code>上面</p>
<figure>
<img src="image-20250517203826678-1756610492748-1.png" alt="使用截图" />
<figcaption aria-hidden="true">使用截图</figcaption>
</figure>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/17/%E7%A7%91%E7%A0%94/first%20stage/%E6%8E%BA%E6%9D%82%E8%B4%A8%E9%87%8F%E8%AE%A1%E7%AE%97/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/14/%E7%A7%91%E7%A0%94/VASP/Starry%20Sky/%E5%88%9D%E5%AD%A6ELF%E7%94%B5%E5%AD%90%E5%B1%80%E5%9F%9F%E5%8C%96%E5%87%BD%E6%95%B0%E7%9A%84%E8%AE%A1%E7%AE%97%E4%B8%8E%E5%88%86%E6%9E%90/"
                            aria-label=": 初学ELF电子定域化函数的计算与分析"
                        >
                            初学ELF电子定域化函数的计算与分析
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-14T15:40:00+08:00">
	
		    May 14, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/VASP/">VASP</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p><strong>本文仅为学习记录，并非教程</strong></p>
<p>这次记录文主要侧重于应用，参考了Sob老师的博文和网络上的各大教程</p>
<h2 id="以fcc-cu为例进行elf计算与分析">以FCC
Cu为例进行ELF计算与分析</h2>
<p>采用FCC面心立方最密堆积的铜单胞，使用vasp计算，先进行结构优化，确认收敛后进行ELF计算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Global Parameters</span><br><span class="line">ISTART =  1            (Read existing wavefunction, if there)</span><br><span class="line">ISPIN  =  2            (Non-Spin polarised DFT)</span><br><span class="line">MAGMOM = 4*0.6</span><br><span class="line"># ICHARG =  11         (Non-self-consistent: GGA/LDA band structures)</span><br><span class="line">LREAL  = .FALSE.       (Projection operators: automatic)</span><br><span class="line"> ENCUT  =  530        (Cut-off energy for plane wave basis set, in eV)</span><br><span class="line"># PREC   =  Accurate   (Precision level: Normal or Accurate, set Accurate when perform structure lattice relaxation calculation)</span><br><span class="line">LWAVE  = .TRUE.        (Write WAVECAR or not)</span><br><span class="line">LCHARG = .TRUE.        (Write CHGCAR or not)</span><br><span class="line">ADDGRID= .TRUE.        (Increase grid, helps GGA convergence)</span><br><span class="line">LASPH  = .TRUE.        (Give more accurate total energies and band structure calculations)</span><br><span class="line">PREC   = Accurate      (Accurate strictly avoids any aliasing or wrap around errors)</span><br><span class="line"># LVTOT  = .TRUE.      (Write total electrostatic potential into LOCPOT or not)</span><br><span class="line"># LVHAR  = .TRUE.      (Write ionic + Hartree electrostatic potential into LOCPOT or not)</span><br><span class="line"># NELECT =             (No. of electrons: charged cells, be careful)</span><br><span class="line"># LPLANE = .TRUE.      (Real space distribution, supercells)</span><br><span class="line"># NWRITE = 2           (Medium-level output)</span><br><span class="line"># KPAR   = 2           (Divides k-grid into separate groups)</span><br><span class="line"># NGXF    = 300        (FFT grid mesh density for nice charge/potential plots)</span><br><span class="line"># NGYF    = 300        (FFT grid mesh density for nice charge/potential plots)</span><br><span class="line"># NGZF    = 300        (FFT grid mesh density for nice charge/potential plots)</span><br><span class="line"></span><br><span class="line">Electronic Relaxation</span><br><span class="line">ISMEAR =  1            (Gaussian smearing, metals:1)</span><br><span class="line">SIGMA  =  0.2         (Smearing value in eV, metals:0.2)</span><br><span class="line">NELM   =  90           (Max electronic SCF steps)</span><br><span class="line">NELMIN =  6            (Min electronic SCF steps)</span><br><span class="line">EDIFF  =  1E-08        (SCF energy convergence, in eV)</span><br><span class="line"># GGA  =  PS           (PBEsol exchange-correlation)</span><br><span class="line"></span><br><span class="line">Ionic Relaxation</span><br><span class="line">NSW    =  0         (Max ionic steps)</span><br><span class="line">IBRION =  -1            (Algorithm: 0-MD, 1-Quasi-New, 2-CG)</span><br><span class="line">ISIF   =  2            (Stress/relaxation: 2-Ions, 3-Shape/Ions/V, 4-Shape/Ions)</span><br><span class="line">EDIFFG = -2E-02        (Ionic convergence, eV/AA)</span><br><span class="line"># ISYM =  2            (Symmetry: 0=none, 2=GGA, 3=hybrids)</span><br><span class="line">LELF = .TRUE.</span><br><span class="line">NPAR = 1</span><br></pre></td></tr></table></figure>
<p>在优化完的结构上进行自洽计算，添加<code>LELF = .TRUE.</code>这个参数，确保<code>ELFCAR</code>文件输出</p>
<p><strong>官方wiki还提到必须显示开启<code>NPAR = 1</code></strong>，然而网上的各大教程都没有提到这一点</p>
<blockquote>
<p>If LELF is set, <a
target="_blank" rel="noopener" href="https://www.vasp.at/wiki/index.php/NPAR">NPAR</a>=1 has to be set
explicitely in the <a
target="_blank" rel="noopener" href="https://www.vasp.at/wiki/index.php/INCAR">INCAR</a> file in
addition</p>
</blockquote>
<p>且有一篇讨论帖：https://wiki.vasp.at/forum/viewtopic.php?t=20020</p>
<p>不过我自己尝试的时候发现超算平台上添加<code>NPAR = 1</code>会报错，而在自己电脑上则不会报错，有点迷、、、</p>
<p>用<code>Vesta</code>载入<code>ELFCAR</code>文件</p>
<h3 id="先设置一下等值面数值"><strong>先设置一下等值面数值</strong></h3>
<p><strong>Isosurface
Level</strong>（等值面水平）是一个关键参数，用于控制可视化电子局域化程度的阈值，VESTA会绘制出ELF等于该值的等值面（isosurface），直观展示电子局域化程度高于该阈值的区</p>
<p>Properties-Isosurfaces-Isosurfaces
level，设置完后可以按以下<code>Tab</code>键就会自动保存应用</p>
<figure>
<img src="image-20250514162641866-1756610520382-1.png"
alt="等值面数值设置" />
<figcaption aria-hidden="true">等值面数值设置</figcaption>
</figure>
<p>这里如果设置0.75的话啥也看不到，因为铜单胞中存在着金属键，并没有很强的局域化电子，而是均匀分布的电子气</p>
<p><strong>高定域性通常出现在共价作用区域、孤对电子区域、原子内核及壳层结构区域
</strong></p>
<h3 id="然后就可以查看elf图了">然后就可以查看ELF图了</h3>
<h4 id="首先是3d的图">首先是<strong>3D的图</strong></h4>
<p>左上角-Edit-Lattice
planes，新建一个图，根据想查看的面的来设置米勒指数hlk，以及设置距离d</p>
<figure>
<img src="image-20250514162858714-1756610520383-2.png"
alt="3D的ELF图" />
<figcaption aria-hidden="true">3D的ELF图</figcaption>
</figure>
<h4 id="然后是2d的图">然后是<strong>2D的图</strong></h4>
<p>左上角-Utilities-2D Data Display-Slice即可</p>
<figure>
<img src="image-20250514163149938-1756610520383-3.png"
alt="同一个截面的2D图和3D图" />
<figcaption aria-hidden="true">同一个截面的2D图和3D图</figcaption>
</figure>
<figure>
<img src="ELFCAR-1756610520383-5.png" alt="001,1xd的二维截面ELF图" />
<figcaption aria-hidden="true">001,1xd的二维截面ELF图</figcaption>
</figure>
<p>可以看到，顶点Cu与顶点Cu原子之间、顶点Cu和面心Cu之间的电子的局域化程度比较高并且没有明显的偏向偏离</p>
<h4
id="接下来看一下一维时的电子定域化情况"><strong>接下来看一下一维时的电子定域化情况</strong></h4>
<p>左上角-Utilities-Line profile即可</p>
<ul>
<li>首先棱上的情况</li>
</ul>
<figure>
<img src="image-20250514165646920-1756610520383-4.png"
alt="边长上的ELF图" />
<figcaption aria-hidden="true">边长上的ELF图</figcaption>
</figure>
<blockquote>
<p>Cu和Cu两原子中间存在均匀的非零的电子局域函数，虽然不足0.5但分布平坦，这是金属键合的特征</p>
</blockquote>
<p><strong>两个铜原子的ELF(r)值相近</strong></p>
<ul>
<li>面对角线上的情况</li>
</ul>
<figure>
<img src="image-20250514170323442-1756610520383-6.png" alt="面对角线" />
<figcaption aria-hidden="true">面对角线</figcaption>
</figure>
<p><strong>三个铜原子的ELF(r)值相近</strong></p>
<h2 id="离子晶体csf">离子晶体CsF</h2>
<p>再看一下离子键的情况，以CsF为例</p>
<figure>
<img src="image-20250514173537672-1756610520383-7.png"
alt="CsF的ELF图" />
<figcaption aria-hidden="true">CsF的ELF图</figcaption>
</figure>
<p>氟和铯之间出现深蓝色，这说明在这个区域电子的分布较为离域化，即氟和铯之间不存在共用电子，键的类型偏向离子键</p>
<p>再看看对角线上的电荷分布</p>
<figure>
<img src="image-20250514174030053-1756610520383-8.png"
alt="对角线上的一维ELF图" />
<figcaption aria-hidden="true">对角线上的一维ELF图</figcaption>
</figure>
<p>两端为铯中间为氟，可以看到氟和铯ELF(r)值差别较大</p>
<h2 id="共价晶体硅">共价晶体——硅</h2>
<figure>
<img src="image-20250514175250902-1756610520383-9.png"
alt="101截面的ELF图" />
<figcaption aria-hidden="true">101截面的ELF图</figcaption>
</figure>
<p>如箭头所指，硅原子和硅原子之间有较强的电子定域化作用，键的类型为共价键</p>
<p>如下图，体对角线上的ELF图也能很好证明，Si-Si之间的区域电子化定域程度极高，呈现明显的尖峰</p>
<figure>
<img src="image-20250514180004023-1756610520383-10.png"
alt="对角线上的ELF图" />
<figcaption aria-hidden="true">对角线上的ELF图</figcaption>
</figure>
<h2 id="共价晶体灰锡">共价晶体——灰锡</h2>
<p>我仍记得高中时课本讲的一个稍微有些特殊的例子——灰锡，灰锡是一个<strong>共价晶体</strong></p>
<figure>
<img src="image-20250514191631604-1756610520383-11.png"
alt="灰锡101晶面的ELF图" />
<figcaption aria-hidden="true">灰锡101晶面的ELF图</figcaption>
</figure>
<p>可以看到，灰锡与晶体硅结构上类似，Sn(<span
class="math inline">$\frac{1}{4},\frac{1}{4},\frac{1}{4}$</span>)与Sn(0,0,0)与以及Sn(0.5,0.5,0)成键，Sn(<span
class="math inline">$\frac{3}{4},\frac{3}{4},\frac{1}{4}$</span>)与Sn(0.5,0.5,0)和Sn(1,1,0)成键。成键电子局域化程度较高，为共价电子</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/14/%E7%A7%91%E7%A0%94/VASP/Starry%20Sky/%E5%88%9D%E5%AD%A6ELF%E7%94%B5%E5%AD%90%E5%B1%80%E5%9F%9F%E5%8C%96%E5%87%BD%E6%95%B0%E7%9A%84%E8%AE%A1%E7%AE%97%E4%B8%8E%E5%88%86%E6%9E%90/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/12/%E7%A7%91%E7%A0%94/VASP/2025-04-21-2025%E5%B9%B44%E6%9C%88Intel%E5%B9%B3%E5%8F%B0VASP.6.4.3%E7%9A%84%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/"
                            aria-label=": 2025年5月Intel平台VASP.6.4.3的编译安装"
                        >
                            2025年5月Intel平台VASP.6.4.3的编译安装
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-12T22:40:00+08:00">
	
		    May 12, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/VASP/">VASP</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h1
id="年5月intel平台vasp.6.4.3的编译安装">2025年5月Intel平台VASP.6.4.3的编译安装</h1>
<hr />
<h2 id="wsl的安装">WSL的安装</h2>
<p>选择<code>Arch Linux</code>，个人比较熟悉，仅供学习使用不作为稳定的生产力环境，配置如下，两颗E5
2676 v3</p>
<figure>
<img src="image-20250421212627422-1756610835113-1.png"
alt="洋垃圾配置" />
<figcaption aria-hidden="true">洋垃圾配置</figcaption>
</figure>
<p>打开<code>powershell</code>或者<code>终端</code>，输入<code>wsl --install archlinux</code>以自动安装，这一步需要使用代理(MAGIC)，主机上使用<code>Clash-Verge</code>进行代理（运气好也能连上），<code>终端</code>中输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> http_proxy=http://127.0.0.1:7897 <span class="comment">#自己使用的端口是7897，http代理</span></span><br><span class="line"><span class="built_in">set</span> https_proxy=http://127.0.0.1:7897 <span class="comment">#自己使用的端口是7897，https代理</span></span><br></pre></td></tr></table></figure>
<p>如果没有条件使用代理，也可以手动安装，参考<code>Arch Wiki</code>，https://wiki.archlinuxcn.org/wiki/%E5%9C%A8_WSL_%E4%B8%8A%E5%AE%89%E8%A3%85_Arch_Linux，手动下载<code>.wsl</code>镜像，然后安装</p>
<p>笔者计算机C盘性能太差，于是想要将wsl2迁移到另一个分区</p>
<p>安装成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@NAS ~]# fastfetch</span><br><span class="line">                  -`                     root@NAS</span><br><span class="line">                 .o+`                    --------</span><br><span class="line">                `ooo/                    OS: Arch Linux x86_64</span><br><span class="line">               `+oooo:                   Host: Windows Subsystem <span class="keyword">for</span> Linux - archlinux (2.4.12)</span><br><span class="line">              `+oooooo:                  Kernel: Linux 5.15.167.4-microsoft-standard-WSL2</span><br><span class="line">              -+oooooo+:                 Uptime: 5 hours, 16 mins</span><br><span class="line">            `/:-:++oooo+:                Packages: 155 (pacman)</span><br><span class="line">           `/++++/+++++++:               Shell: bash 5.2.37</span><br><span class="line">          `/++++++++++++++:              WM: WSLg 1.0.65 (Wayland)</span><br><span class="line">         `/+++ooooooooooooo/`            Terminal: xterm-256color</span><br><span class="line">        ooosssso++osssssso+`           CPU: Intel(R) Xeon(R) E5-2676 v3 (48) @ 2.39 GHz</span><br><span class="line">       .oossssso-````/ossssss+`          Memory: 1.09 GiB / 15.57 GiB (7%)</span><br><span class="line">      -osssssso.      :ssssssso.         Swap: 304.95 MiB / 4.00 GiB (7%)</span><br><span class="line">     :osssssss/        osssso+++.        Disk (/): 18.67 GiB / 1006.85 GiB (2%) - ext4</span><br><span class="line">    /ossssssss/        +ssssooo/-        Disk (/mnt/c): 159.05 GiB / 237.01 GiB (67%) - 9p</span><br><span class="line">  `/ossssso+/:-        -:/+osssso+-      Disk (/mnt/d): 13.16 TiB / 14.55 TiB (90%) - 9p</span><br><span class="line"> `+sso+:-`                 `.-/+oso:     Disk (/mnt/e): 1.70 TiB / 3.64 TiB (47%) - 9p</span><br><span class="line">`++:.                           `-/+/    Disk (/mnt/f): 49.45 GiB / 476.94 GiB (10%) - 9p</span><br><span class="line">.`                                 `/    Disk (/mnt/g): 25.16 TiB / 29.10 TiB (86%) - 9p</span><br><span class="line">                                         Local IP (eth0): 172.31.36.99/20</span><br><span class="line">                                         Locale: en_US.UTF-8</span><br></pre></td></tr></table></figure>
<h2 id="编译器的安装">编译器的安装</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pacman -S make</span><br><span class="line">pacman -S cmake</span><br><span class="line">pacman -S gcc</span><br><span class="line">pacman -S gcc-fortran</span><br><span class="line"><span class="comment">####发现gcc和gfortran编译器太新，会编报错(C23)，故降级软件包</span></span><br><span class="line"><span class="comment">#添加中科大源来安装yay</span></span><br><span class="line">pacman -Syy yay</span><br><span class="line">yay -S downgrade <span class="comment">#安装降级工具</span></span><br><span class="line">downgrade -S gcc-libs <span class="comment">#选择12.1.0版本，安装gcc的依赖</span></span><br><span class="line">downgrade -S gcc <span class="comment">#安装gcc，选择12.1.0版本</span></span><br><span class="line">downgrade -S gcc-fortran <span class="comment">#安装gforran，选择12.1.0版本</span></span><br></pre></td></tr></table></figure>
<p>前往Intel官网下载oneAPI BaseTool
kithttps://www.intel.com/content/www/us/en/developer/tools/oneapi/base-toolkit-download.html?packages=oneapi-toolkit&amp;oneapi-toolkit-os=linux&amp;oneapi-lin=online</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x xxxxxxxxxx.sh <span class="comment">#赋予下载下来的sh文件可执行权限</span></span><br><span class="line">xxxx.sh <span class="comment">#运行sh文件</span></span><br></pre></td></tr></table></figure>
<p>oneAPI BaseTool kit不需要全部安装，只需安装MKL部分，</p>
<p>HPC也只需安装一部分</p>
<p>此处博主踩了较多的坑：</p>
<ul>
<li>编译器采用2022版，不可采用过新编译器
<ul>
<li>2024年10月后，Intel删除了ifort编译器</li>
</ul></li>
<li>gcc编译器不可太新，否则编译某些<code>fortran</code>模块会报错，博主从14降级到了12.1.0</li>
</ul>
<h2 id="vasp.6.4.3的编译安装">VASP.6.4.3的编译安装</h2>
<p>源码包可以去各大私密性较强的论坛或者微信公众号获取，仅供个人学习使用，不用于学术、商业用途</p>
<p>选择<code>arch/</code>目录中的模板<code>makefile.include.intel</code>，复制到<code>.</code>(上一层目录)，并修改名称为<code>makefile.include</code>，修改目录如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Default precompiler options</span></span><br><span class="line">CPP_OPTIONS = -DHOST=\&quot;LinuxIFC\&quot; \</span><br><span class="line">              -DMPI -DMPI_BLOCK=8000 -Duse_collective \</span><br><span class="line">              -DscaLAPACK \</span><br><span class="line">              -DCACHE_SIZE=4000 \</span><br><span class="line">              -Davoidalloc \</span><br><span class="line">              -Dvasp6 \</span><br><span class="line">              -Duse_bse_te \</span><br><span class="line">              -Dtbdyn \</span><br><span class="line">              -Dfock_dblbuf</span><br><span class="line"></span><br><span class="line">CPP         = fpp -f_com=no -free -w0  $*$(FUFFIX) $*$(SUFFIX) $(CPP_OPTIONS)</span><br><span class="line"></span><br><span class="line">FC          = mpiifort</span><br><span class="line">FCL         = mpiifort</span><br><span class="line"></span><br><span class="line">FREE        = -free -names lowercase</span><br><span class="line"></span><br><span class="line">FFLAGS      = -assume byterecl -w</span><br><span class="line"></span><br><span class="line">OFLAG       = -O2 -xhost  <span class="comment">#添加-xhost标记</span></span><br><span class="line">OFLAG_IN    = $(OFLAG)</span><br><span class="line">DEBUG       = -O0</span><br><span class="line"></span><br><span class="line">OBJECTS     = fftmpiw.o fftmpi_map.o fftw3d.o fft3dlib.o</span><br><span class="line">OBJECTS_O1 += fftw3d.o fftmpi.o fftmpiw.o</span><br><span class="line">OBJECTS_O2 += fft3dlib.o</span><br><span class="line"></span><br><span class="line"><span class="comment"># For what used to be vasp.5.lib</span></span><br><span class="line">CPP_LIB     = $(CPP)</span><br><span class="line">FC_LIB      = $(FC)</span><br><span class="line">CC_LIB      = icc</span><br><span class="line">CFLAGS_LIB  = -O</span><br><span class="line">FFLAGS_LIB  = -O1</span><br><span class="line">FREE_LIB    = $(FREE)</span><br><span class="line"></span><br><span class="line">OBJECTS_LIB = linpack_double.o</span><br><span class="line"></span><br><span class="line"><span class="comment"># For the parser library</span></span><br><span class="line">CXX_PARS    = icpc</span><br><span class="line">LLIBS       = -lstdc++</span><br><span class="line"></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Customize as of this point! Of course you may change the preceding</span></span><br><span class="line"><span class="comment">## part of this file as well if you like, but it should rarely be</span></span><br><span class="line"><span class="comment">## necessary ...</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># When compiling on the target machine itself, change this to the</span></span><br><span class="line"><span class="comment"># relevant target when cross-compiling for another architecture</span></span><br><span class="line">VASP_TARGET_CPU ?= -xHOST</span><br><span class="line">FFLAGS     += $(VASP_TARGET_CPU)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Intel MKL (FFTW, BLAS, LAPACK, and scaLAPACK)</span></span><br><span class="line"><span class="comment"># (Note: for Intel Parallel Studio&#x27;s MKL use -mkl instead of -qmkl)</span></span><br><span class="line">FCL        += -qmkl=sequential</span><br><span class="line">MKLROOT    ?= /opt/intel/oneapi/mkl/2022.1.0 <span class="comment">#一定要添加MKLROOT的目录，否则会报错</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/home/storm/intel/oneapi/mkl/2022.1.0</span><br><span class="line">LLIBS      += -L$(MKLROOT)/lib/intel64 -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp64</span><br><span class="line">INCS        =-I$(MKLROOT)/include/fftw</span><br><span class="line"></span><br><span class="line"><span class="comment"># HDF5-support (optional but strongly recommended)</span></span><br><span class="line"><span class="comment">#CPP_OPTIONS+= -DVASP_HDF5</span></span><br><span class="line"><span class="comment">#HDF5_ROOT  ?= /path/to/your/hdf5/installation</span></span><br><span class="line"><span class="comment">#LLIBS      += -L$(HDF5_ROOT)/lib -lhdf5_fortran</span></span><br><span class="line"><span class="comment">#INCS       += -I$(HDF5_ROOT)/include</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># For the VASP-2-Wannier90 interface (optional)</span></span><br><span class="line"><span class="comment">#CPP_OPTIONS    += -DVASP2WANNIER90</span></span><br><span class="line"><span class="comment">#WANNIER90_ROOT ?= /path/to/your/wannier90/installation</span></span><br><span class="line"><span class="comment">#LLIBS          += -L$(WANNIER90_ROOT)/lib -lwannier</span></span><br></pre></td></tr></table></figure>
<p>然后开始编译</p>
<p>发现使用命令<code>make all -j48</code>会编译报错</p>
<p>于是改为官方wiki的命令<code>make DEPS=1 -j48</code>，编译成功</p>
<h2 id="测试">测试</h2>
<p><code>make test</code>进行测试，有一些报错，懒得管了、、、能跑就行</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/12/%E7%A7%91%E7%A0%94/VASP/2025-04-21-2025%E5%B9%B44%E6%9C%88Intel%E5%B9%B3%E5%8F%B0VASP.6.4.3%E7%9A%84%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a
                            class="link-unstyled"
                            href="/2025/05/12/%E7%A7%91%E7%A0%94/VASP/Starry%20Sky/Vaspkit%E7%9A%84%E4%BD%BF%E7%94%A8/"
                            aria-label=": Vaspkit的使用"
                        >
                            Vaspkit的使用
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2025-05-12T10:40:00+08:00">
	
		    May 12, 2025
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/">从零开始的科研之旅</a>, <a class="category-link" href="/all-categories/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84%E7%A7%91%E7%A0%94%E4%B9%8B%E6%97%85/VASP/">VASP</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>安装、配置好<code>vaspkit</code>之后输入<code>vaspkit</code>可启动软件包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">(base) storm@DESKTOP-HE4FQ8Q:~/my-learn/trash-vaspkit$ vaspkit</span><br><span class="line">            \\\///</span><br><span class="line">           / _  _ \         Hey, you must know what you are doing.</span><br><span class="line">         (| (o)(o) |)       Otherwise you might get wrong results.</span><br><span class="line"> o-----.OOOo--()--oOOO.------------------------------------------o</span><br><span class="line"> |         VASPKIT Standard Edition 1.5.1 (27 Jan. 2024)         |</span><br><span class="line"> |         Lead Developer: Vei WANG (wangvei@icloud.com)         |</span><br><span class="line"> |      Main Contributors: Gang TANG, Nan XU &amp; Jin-Cheng LIU     |</span><br><span class="line"> |  Online Tutorials Available on Website: https://vaspkit.com   |</span><br><span class="line"> o-----.oooO-----------------------------------------------------o</span><br><span class="line">        (   )   Oooo.                          VASPKIT Made Simple</span><br><span class="line">         \ (    (   )</span><br><span class="line">          \_)    ) /</span><br><span class="line">                (_/</span><br><span class="line"> ===================== Structural Utilities ======================</span><br><span class="line"> 01) VASP Input-Files Generator    02) Mechanical Properties</span><br><span class="line"> 03) K-Path <span class="keyword">for</span> Band-Structure     04) Structure Editor</span><br><span class="line"> 05) Catalysis-ElectroChem Kit     06) Symmetry Analysis</span><br><span class="line"> 07) Materials Databases           08) Advanced Structure Models</span><br><span class="line"> ===================== Electronic Utilities ======================</span><br><span class="line"> 11) Density-of-States             21) Band-Structure</span><br><span class="line"> 23) 3D Band-Structure             25) Hybrid-DFT Band-Structure</span><br><span class="line"> 26) Fermi-Surface                 28) Band-Structure Unfolding</span><br><span class="line"> 31) Charge-Density Analysis       42) Potential Analysis</span><br><span class="line"> 44) Piezoelectric Properties      51) Wave-Function Analysis</span><br><span class="line"> 62) Magnetic Analysis             65) Spin-Texture</span><br><span class="line"> 68) Transport Properties</span><br><span class="line"> ======================== Misc Utilities =========================</span><br><span class="line"> 71) Optical Properties            72) Molecular-Dynamics Kit</span><br><span class="line"> 74) User Interface                78) VASP2other Interface</span><br><span class="line"> 84) ABACUS Interface              91) Semiconductor Kit</span><br><span class="line"> 92) 2D-Material Kit               95) Phonon Analysis</span><br><span class="line"> 0)  Quit</span><br><span class="line"> ------------&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>以下是中文翻译对照：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">===================== 结构工具 ======================</span><br><span class="line">01) VASP 输入文件生成器</span><br><span class="line">02) 力学性质</span><br><span class="line">03) 能带结构的 K 路径</span><br><span class="line">04) 结构编辑器</span><br><span class="line">05) 催化 - 电化学套件</span><br><span class="line">06) 对称性分析</span><br><span class="line">07) 材料数据库</span><br><span class="line">08) 高级结构模型</span><br><span class="line">==================== 电子工具 ======================</span><br><span class="line">11) 密度态</span><br><span class="line">21) 能带结构</span><br><span class="line">23) 三维能带结构</span><br><span class="line">25) 混合 DFT 能带结构</span><br><span class="line">26) 费米面</span><br><span class="line">28) 能带结构展开</span><br><span class="line">31) 电荷密度分析</span><br><span class="line">42) 势分析</span><br><span class="line">44) 压电性质</span><br><span class="line">51) 波函数分析</span><br><span class="line">62) 磁性分析</span><br><span class="line">65) 自旋纹理</span><br><span class="line">68) 输运性质</span><br><span class="line">====================== 杂项工具 ========================</span><br><span class="line">71) 光学性质</span><br><span class="line">72) 分子动力学套件</span><br><span class="line">74) 用户界面</span><br><span class="line">78) VASP 转其他格式接口</span><br><span class="line">84) ABACUS 接口</span><br><span class="line">91) 半导体套件</span><br><span class="line">92) 二维材料套件</span><br><span class="line">95) 声子分析</span><br><span class="line">0) 退出</span><br></pre></td></tr></table></figure>
<p>我目前还是初学者小白，使用得最多的功能还是生成输入文件功能尤其是生成<code>INCAR</code>文件，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"> ------------&gt;&gt;</span><br><span class="line">01</span><br><span class="line"> ==================== VASP Input Files Options ===================</span><br><span class="line"> 101) Customize INCAR File</span><br><span class="line"> 102) Generate KPOINTS File <span class="keyword">for</span> SCF Calculation</span><br><span class="line"> 103) Generate POTCAR File with Default Setting</span><br><span class="line"> 104) Generate POTCAR File with User Specified Potential</span><br><span class="line"> 105) Generate POSCAR File from cif (no fractional occupations)</span><br><span class="line"> 106) Generate POSCAR File from Material Studio xsd (retain fixes)</span><br><span class="line"> 107) Reformat POSCAR File <span class="keyword">in</span> Specified Order of Elements</span><br><span class="line"> 108) Successive Procedure to Generate VASP Files and Check</span><br><span class="line"> 109) Submit Job Queue</span><br><span class="line"></span><br><span class="line"> 0)   Quit</span><br><span class="line"> 9)   Back</span><br><span class="line"> ------------&gt;&gt;</span><br><span class="line">  ------------&gt;&gt;</span><br><span class="line">101</span><br><span class="line"> +---------------------------- Tip ------------------------------+</span><br><span class="line"> |          WARNNING: You MUST know what wou are doing!          |</span><br><span class="line"> |Some Parameters <span class="keyword">in</span> INCAR file need to be <span class="built_in">set</span>/adjusted manually.|</span><br><span class="line"> +---------------------------------------------------------------+</span><br><span class="line"> ======================== INCAR Options ==========================</span><br><span class="line"> ST) Static-Calculation            SR) Standard Relaxation</span><br><span class="line"> MG) Magnetic Properties           SO) Spin-Orbit Coupling</span><br><span class="line"> D3) DFT-D3 no-damping Correction  H6) HSE06 Calculation</span><br><span class="line"> PU) DFT+U Calculation             MD) Molecular Dynamics</span><br><span class="line"> GW) GW0 Calculation               BS) BSE Calculation</span><br><span class="line"> DC) Elastic Constant              EL) ELF Calculation</span><br><span class="line"> BD) Bader Charge Analysis         OP) Optical Properties</span><br><span class="line"> EC) Static Dielectric Constant    PC) Decomposed Charge Density</span><br><span class="line"> PH) Phonon-Calculation            PY) Phonon with Phononpy</span><br><span class="line"> NE) Nudged Elastic Band (NEB)     DM) The Dimer Method</span><br><span class="line"> FQ) Frequence Calculation         LR) Lattice Relaxation</span><br><span class="line"> MT) Meta-GGA Calculation          PZ) Piezoelectric Calculation</span><br><span class="line"></span><br><span class="line"> 0)   Quit</span><br><span class="line"> 9)   Back</span><br><span class="line"> ------------&gt;&gt;</span><br><span class="line"> Input Key-Parameters (STH6D3 means HSE06-D3 Static-Calcualtion)</span><br></pre></td></tr></table></figure>
<p>以下是中文对照：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">+---------------------------- 提示 ------------------------------+</span><br><span class="line">|          警告：你必须清楚自己在做什么！          |</span><br><span class="line">|INCAR 文件中的一些参数需要手动设置/调整。|</span><br><span class="line">+---------------------------------------------------------------+</span><br><span class="line">======================= INCAR 选项 ==========================</span><br><span class="line">ST) 静态计算            SR) 标准松弛</span><br><span class="line">MG) 磁性性质            SO) 自旋轨道耦合</span><br><span class="line">D3) DFT-D3 无阻尼校正  H6) HSE06 计算</span><br><span class="line">PU) DFT+U 计算          MD) 分子动力学</span><br><span class="line">GW) GW0 计算            BS) BSE 计算</span><br><span class="line">DC) 弹性常数            EL) ELF 计算</span><br><span class="line">BD) Bader 电荷分析      OP) 光学性质</span><br><span class="line">EC) 静态介电常数        PC) 分解电荷密度</span><br><span class="line">PH) 声子计算            PY) 使用 Phonopy 的声子计算</span><br><span class="line">NE) 强制弹性带（NEB）   DM) 二聚体方法</span><br><span class="line">FQ) 频率计算            LR) 晶格松弛</span><br><span class="line">MT) Meta-GGA 计算       PZ) 压电计算</span><br></pre></td></tr></table></figure>
<p><code>LR</code>晶格弛豫就对应着结构优化，当然生成的<code>INCAR</code>文件可能仍需要进行一些修改，比如<code>ENCUT</code>可能需要调整为赝势中<code>ENMAX</code>的1.3倍</p>
<h2 id="生成kpoints文件">生成KPOINTS文件</h2>
<p>对于<strong>非能带的计算</strong>，选择<code>102) Generate KPOINTS File for SCF Calculation</code>使用程序自动撒点即可，但是需要用户选择撒点方式和撒点密度，选择<code>Gamma Scheme</code>，使用0.04精度</p>
<blockquote>
<p>关于生成 KPOINTS 文件</p>
<ul>
<li>在 VASP 计算中，KPOINTS 文件用于指定 k
点网格的设置。对于非能带计算，比如进行能量计算、优化结构等，通常不需要像计算能带结构那样沿特定的高对称路径采样
k 点，而是可以在整个布里渊区均匀地分布 k 点，这就是所说的
“自动撒点”。</li>
</ul>
<p>撒点方式</p>
<ul>
<li><strong>Monkhorst-Pack 方式</strong>
：这是最常用的自动撒点方式。它通过指定一组三个整数（nx, ny,
nz），在三个倒易晶格方向上均匀地分布 k
点，形成的网格可以系统地逼近布里渊区的积分。例如，对于简单晶格，若指定 k
点网格为 3×3×3，程序就会按照 Monkhorst-Pack 方式在这三个方向各取 3
个点，生成一个均匀分布的 k 点网格。</li>
<li><strong>Gamma 方式</strong> ：这种方式会在 k 点网格中包含 Γ
点（布里渊区的中心点）。对于金属等具有高对称性的材料，在 Γ
点附近采样很重要，这时候 Gamma 方式撒点更合适。比如指定 k 点网格为 4×4×4
并采用 Gamma 方式撒点，生成的网格会以 Γ 点为中心，向周围均匀分布其他 k
点。</li>
</ul>
<p>K 点密度</p>
<ul>
<li>K 点密度指的是在布里渊区单位体积内分布的 k 点数量，它决定了 k
点网格的疏密程度。较高的 K
点密度意味着更精细地采样布里渊区，能够更精确地计算系统的物理性质，但也会增加计算量和资源消耗。</li>
<li>例如，对于一个计算资源充足的大型超算任务，为了获得高精度结果，可以选择较大的
K 点密度，如 8×8×8
甚至更高；而对于初步探索或计算资源有限的情况，可以适当降低 K 点密度，如
4×4×4。</li>
</ul>
</blockquote>
<p>生成<code>KPOINTS</code>的同时，<code>POTCAR</code>也会被自动生成，前提是在vaspkit的配置文件中正确设置了赝势的路径和赝势稳健的种类（默认type为PBE）</p>

                    
                        


                    
                    
                        <p>
                            <a
                                href="/2025/05/12/%E7%A7%91%E7%A0%94/VASP/Starry%20Sky/Vaspkit%E7%9A%84%E4%BD%BF%E7%94%A8/#post-footer"
                                class="postShorten-excerpt_link link"
                                aria-label=""
                            >
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
          <li class="pagination-prev">
            <a
                class="btn btn--default btn--small"
                href="/all-archives/2025/"
                aria-label="NEWER POSTS"
            >
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>NEWER POSTS</span>
            </a>
          </li>
        
        
          <li class="pagination-next">
            <a
                class="btn btn--default btn--small"
                href="/all-archives/2025/page/3/"
                aria-label="OLDER POSTS"
            >
              <span>OLDER POSTS</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
        <li class="pagination-number">page 2 of 8</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2025 John Doe. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">John Doe</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-akgy1kkmfssyzznzlvk9mjwcvnsn87aqalldnf43rojvlib0s8vpmeb5mayw.min.js"></script>

<!--SCRIPTS END-->





<script src="/js/equals-mark.js"></script>


    </body>
</html>
